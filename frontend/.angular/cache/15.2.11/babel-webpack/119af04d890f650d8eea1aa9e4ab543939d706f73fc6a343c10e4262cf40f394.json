{"ast":null,"code":"import _asyncToGenerator from \"/Users/marieklinaeva/github/ck-board/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./user.service\";\nimport * as i2 from \"./board.service\";\nimport * as i3 from \"@angular/common/http\";\nexport class TraceService {\n  userService;\n  boardService;\n  http;\n  traceContext;\n  board;\n  constructor(userService, boardService, http) {\n    this.userService = userService;\n    this.boardService = boardService;\n    this.http = http;\n    this.traceContext = {\n      userID: '',\n      projectID: '',\n      boardID: '',\n      clientTimestamp: -1,\n      allowTracing: false\n    };\n  }\n  setTraceContext(projectID, boardID) {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      _this.traceContext.boardID = boardID;\n      _this.traceContext.projectID = projectID;\n      _this.traceContext.userID = _this.userService.user?.userID || '';\n      _this.board = yield _this.boardService.get(boardID);\n      _this.traceContext.allowTracing = _this.board.permissions.allowTracing || false;\n    })();\n  }\n  getTraceContext() {\n    this.traceContext.clientTimestamp = Date.now();\n    return this.traceContext;\n  }\n  getTraceRecords(projectID) {\n    return this.http.get('trace/' + projectID).toPromise();\n  }\n  static ɵfac = function TraceService_Factory(t) {\n    return new (t || TraceService)(i0.ɵɵinject(i1.UserService), i0.ɵɵinject(i2.BoardService), i0.ɵɵinject(i3.HttpClient));\n  };\n  static ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: TraceService,\n    factory: TraceService.ɵfac,\n    providedIn: 'root'\n  });\n}","map":{"version":3,"mappings":";;;;;AAWA,OAAM,MAAOA,YAAY;EAIbC;EACAC;EACAC;EALVC,YAAY;EACZC,KAAK;EACLC,YACUL,WAAwB,EACxBC,YAA0B,EAC1BC,IAAgB;IAFhB,gBAAW,GAAXF,WAAW;IACX,iBAAY,GAAZC,YAAY;IACZ,SAAI,GAAJC,IAAI;IAEZ,IAAI,CAACC,YAAY,GAAG;MAClBG,MAAM,EAAE,EAAE;MACVC,SAAS,EAAE,EAAE;MACbC,OAAO,EAAE,EAAE;MACXC,eAAe,EAAE,CAAC,CAAC;MACnBC,YAAY,EAAE;KACf;EACH;EACMC,eAAe,CAACJ,SAAiB,EAAEC,OAAe;IAAA;IAAA;MACtD,KAAI,CAACL,YAAY,CAACK,OAAO,GAAGA,OAAO;MACnC,KAAI,CAACL,YAAY,CAACI,SAAS,GAAGA,SAAS;MACvC,KAAI,CAACJ,YAAY,CAACG,MAAM,GAAG,KAAI,CAACN,WAAW,CAACY,IAAI,EAAEN,MAAM,IAAI,EAAE;MAC9D,KAAI,CAACF,KAAK,SAAS,KAAI,CAACH,YAAY,CAACY,GAAG,CAACL,OAAO,CAAC;MACjD,KAAI,CAACL,YAAY,CAACO,YAAY,GAC5B,KAAI,CAACN,KAAK,CAACU,WAAW,CAACJ,YAAY,IAAI,KAAK;IAAC;EACjD;EACAK,eAAe;IACb,IAAI,CAACZ,YAAY,CAACM,eAAe,GAAGO,IAAI,CAACC,GAAG,EAAE;IAC9C,OAAO,IAAI,CAACd,YAAY;EAC1B;EACAe,eAAe,CAACX,SAAiB;IAC/B,OAAO,IAAI,CAACL,IAAI,CAACW,GAAG,CAAU,QAAQ,GAAGN,SAAS,CAAC,CAACY,SAAS,EAAE;EACjE;;qBA9BWpB,YAAY;EAAA;;WAAZA,YAAY;IAAAqB,SAAZrB,YAAY;IAAAsB,YAFX;EAAM","names":["TraceService","userService","boardService","http","traceContext","board","constructor","userID","projectID","boardID","clientTimestamp","allowTracing","setTraceContext","user","get","permissions","getTraceContext","Date","now","getTraceRecords","toPromise","factory","providedIn"],"sourceRoot":"","sources":["/Users/marieklinaeva/github/ck-board/frontend/src/app/services/trace.service.ts"],"sourcesContent":["import { HttpClient } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Board } from '../models/board';\nimport { Trace } from '../models/trace';\nimport { TraceContext } from '../models/traceContext';\nimport { BoardService } from './board.service';\nimport { UserService } from './user.service';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class TraceService {\n  traceContext: TraceContext;\n  board: Board;\n  constructor(\n    private userService: UserService,\n    private boardService: BoardService,\n    private http: HttpClient\n  ) {\n    this.traceContext = {\n      userID: '',\n      projectID: '',\n      boardID: '',\n      clientTimestamp: -1,\n      allowTracing: false,\n    };\n  }\n  async setTraceContext(projectID: string, boardID: string) {\n    this.traceContext.boardID = boardID;\n    this.traceContext.projectID = projectID;\n    this.traceContext.userID = this.userService.user?.userID || '';\n    this.board = await this.boardService.get(boardID);\n    this.traceContext.allowTracing =\n      this.board.permissions.allowTracing || false;\n  }\n  getTraceContext(): TraceContext {\n    this.traceContext.clientTimestamp = Date.now();\n    return this.traceContext;\n  }\n  getTraceRecords(projectID: string) {\n    return this.http.get<Trace[]>('trace/' + projectID).toPromise();\n  }\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}