{"ast":null,"code":"import _asyncToGenerator from \"/Users/marieklinaeva/github/ck-board/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { ViewType } from 'src/app/models/board';\nimport { Role } from 'src/app/models/user';\nimport { TaskActionType, GroupTaskStatus } from 'src/app/models/workflow';\nimport { BucketsModalComponent } from '../buckets-modal/buckets-modal.component';\nimport { ListModalComponent } from '../list-modal/list-modal.component';\nimport { SwiperComponent } from 'swiper/angular';\nimport SwiperCore, { EffectCards } from 'swiper';\nimport Converters from 'src/app/utils/converters';\nimport { EXPANDED_TODO_TYPE, SocketEvent, TODO_TYPE_COLORS, EXPANDED_COMPLETION_QUALITY } from 'src/app/utils/constants';\nimport { ManageGroupModalComponent } from '../groups/manage-group-modal/manage-group-modal.component';\nimport { MatTableDataSource } from '@angular/material/table';\nimport { MatSort } from '@angular/material/sort';\nimport sorting from 'src/app/utils/sorting';\nimport { FormControl, FormGroup } from '@angular/forms';\nimport { TodoItemCardModalComponent } from '../todo-item-card-modal/todo-item-card-modal.component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/user.service\";\nimport * as i2 from \"src/app/services/project.service\";\nimport * as i3 from \"src/app/services/board.service\";\nimport * as i4 from \"src/app/services/post.service\";\nimport * as i5 from \"src/app/services/workflow.service\";\nimport * as i6 from \"src/app/services/group.service\";\nimport * as i7 from \"src/app/services/socket.service\";\nimport * as i8 from \"src/app/services/snackbar.service\";\nimport * as i9 from \"src/app/services/todoItem.service\";\nimport * as i10 from \"src/app/services/learner.service\";\nimport * as i11 from \"@angular/router\";\nimport * as i12 from \"@angular/material/dialog\";\nfunction CkMonitorComponent_app_toolbar_1_span_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r8 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"CK Monitor - \", ctx_r8.board.name, \"\");\n  }\n}\nfunction CkMonitorComponent_app_toolbar_1_button_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r11 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 14);\n    i0.ɵɵlistener(\"click\", function CkMonitorComponent_app_toolbar_1_button_2_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r10 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r10.copyEmbedCode());\n    });\n    i0.ɵɵelementStart(1, \"mat-icon\");\n    i0.ɵɵtext(2, \"file_copy\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction CkMonitorComponent_app_toolbar_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"app-toolbar\", 8);\n    i0.ɵɵtemplate(1, CkMonitorComponent_app_toolbar_1_span_1_Template, 2, 1, \"span\", 4);\n    i0.ɵɵtemplate(2, CkMonitorComponent_app_toolbar_1_button_2_Template, 3, 0, \"button\", 9);\n    i0.ɵɵelement(3, \"span\", 10);\n    i0.ɵɵelementStart(4, \"button\", 11)(5, \"mat-icon\");\n    i0.ɵɵtext(6, \"keyboard_return\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelement(7, \"app-view-navigation\", 12)(8, \"app-toolbar-menu\", 13);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"user\", ctx_r0.user)(\"embedded\", ctx_r0.embedded);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.board);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.user.role === ctx_r0.Role.TEACHER);\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate(\"routerLink\", \"/project/\" + ctx_r0.project.projectID + \"/board/\" + ctx_r0.board.boardID);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"boardID\", ctx_r0.board.boardID)(\"currentView\", ctx_r0.viewType);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"board\", ctx_r0.board)(\"project\", ctx_r0.project);\n  }\n}\nfunction CkMonitorComponent_mat_sidenav_3_ng_container_9_mat_list_item_1_span_9_span_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const group_r21 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", group_r21.groupName, \"\\u00A0 \");\n  }\n}\nfunction CkMonitorComponent_mat_sidenav_3_ng_container_9_mat_list_item_1_span_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtemplate(1, CkMonitorComponent_mat_sidenav_3_ng_container_9_mat_list_item_1_span_9_span_1_Template, 2, 1, \"span\", 4);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const group_r21 = ctx.$implicit;\n    const ctx_r18 = i0.ɵɵnextContext(4);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", group_r21.groupStatus === ctx_r18.GroupTaskStatus.INACTIVE);\n  }\n}\nfunction CkMonitorComponent_mat_sidenav_3_ng_container_9_mat_list_item_1_button_11_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r26 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 26);\n    i0.ɵɵlistener(\"click\", function CkMonitorComponent_mat_sidenav_3_ng_container_9_mat_list_item_1_button_11_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r26);\n      const workflow_r17 = i0.ɵɵnextContext().$implicit;\n      const ctx_r24 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r24.view(workflow_r17, ctx_r24.GroupTaskStatus.INACTIVE));\n    });\n    i0.ɵɵtext(1, \" Monitor Task \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CkMonitorComponent_mat_sidenav_3_ng_container_9_mat_list_item_1_button_12_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r28 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 26);\n    i0.ɵɵlistener(\"click\", function CkMonitorComponent_mat_sidenav_3_ng_container_9_mat_list_item_1_button_12_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r28);\n      const ctx_r27 = i0.ɵɵnextContext(4);\n      return i0.ɵɵresetView(ctx_r27.close());\n    });\n    i0.ɵɵtext(1, \" Hide Task \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CkMonitorComponent_mat_sidenav_3_ng_container_9_mat_list_item_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-list-item\")(1, \"mat-icon\", 22);\n    i0.ɵɵtext(2, \"timeline\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"h3\", 23);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"p\", 24);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"p\", 24);\n    i0.ɵɵtext(8, \" Groups: \");\n    i0.ɵɵtemplate(9, CkMonitorComponent_mat_sidenav_3_ng_container_9_mat_list_item_1_span_9_Template, 2, 1, \"span\", 21);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(10, \"span\", 10);\n    i0.ɵɵtemplate(11, CkMonitorComponent_mat_sidenav_3_ng_container_9_mat_list_item_1_button_11_Template, 2, 0, \"button\", 25);\n    i0.ɵɵtemplate(12, CkMonitorComponent_mat_sidenav_3_ng_container_9_mat_list_item_1_button_12_Template, 2, 0, \"button\", 25);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const workflow_r17 = ctx.$implicit;\n    const ctx_r16 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", workflow_r17.name, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", workflow_r17.prompt, \" \");\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r16.taskWorkflowNameMap.get(workflow_r17));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r16.runningTask && (ctx_r16.runningTask.workflowID !== workflow_r17.workflowID || ctx_r16.runningTaskGroupStatus !== ctx_r16.GroupTaskStatus.INACTIVE) || !ctx_r16.runningTask);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r16.runningTask && ctx_r16.runningTask.workflowID === workflow_r17.workflowID && ctx_r16.runningTaskGroupStatus === ctx_r16.GroupTaskStatus.INACTIVE);\n  }\n}\nfunction CkMonitorComponent_mat_sidenav_3_ng_container_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, CkMonitorComponent_mat_sidenav_3_ng_container_9_mat_list_item_1_Template, 13, 5, \"mat-list-item\", 21);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r13 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r13.inactiveTaskWorkflows);\n  }\n}\nfunction CkMonitorComponent_mat_sidenav_3_ng_container_15_mat_list_item_1_span_9_span_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const group_r34 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", group_r34.groupName, \"\\u00A0 \");\n  }\n}\nfunction CkMonitorComponent_mat_sidenav_3_ng_container_15_mat_list_item_1_span_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtemplate(1, CkMonitorComponent_mat_sidenav_3_ng_container_15_mat_list_item_1_span_9_span_1_Template, 2, 1, \"span\", 4);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const group_r34 = ctx.$implicit;\n    const ctx_r31 = i0.ɵɵnextContext(4);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", group_r34.groupStatus === ctx_r31.GroupTaskStatus.ACTIVE);\n  }\n}\nfunction CkMonitorComponent_mat_sidenav_3_ng_container_15_mat_list_item_1_button_11_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r39 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 26);\n    i0.ɵɵlistener(\"click\", function CkMonitorComponent_mat_sidenav_3_ng_container_15_mat_list_item_1_button_11_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r39);\n      const workflow_r30 = i0.ɵɵnextContext().$implicit;\n      const ctx_r37 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r37.view(workflow_r30, ctx_r37.GroupTaskStatus.ACTIVE));\n    });\n    i0.ɵɵtext(1, \" Monitor Task \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CkMonitorComponent_mat_sidenav_3_ng_container_15_mat_list_item_1_button_12_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r41 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 26);\n    i0.ɵɵlistener(\"click\", function CkMonitorComponent_mat_sidenav_3_ng_container_15_mat_list_item_1_button_12_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r41);\n      const ctx_r40 = i0.ɵɵnextContext(4);\n      return i0.ɵɵresetView(ctx_r40.close());\n    });\n    i0.ɵɵtext(1, \" Hide Task \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CkMonitorComponent_mat_sidenav_3_ng_container_15_mat_list_item_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-list-item\")(1, \"mat-icon\", 22);\n    i0.ɵɵtext(2, \"timeline\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"h3\", 23);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"p\", 24);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"p\", 24);\n    i0.ɵɵtext(8, \" Groups: \");\n    i0.ɵɵtemplate(9, CkMonitorComponent_mat_sidenav_3_ng_container_15_mat_list_item_1_span_9_Template, 2, 1, \"span\", 21);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(10, \"span\", 10);\n    i0.ɵɵtemplate(11, CkMonitorComponent_mat_sidenav_3_ng_container_15_mat_list_item_1_button_11_Template, 2, 0, \"button\", 25);\n    i0.ɵɵtemplate(12, CkMonitorComponent_mat_sidenav_3_ng_container_15_mat_list_item_1_button_12_Template, 2, 0, \"button\", 25);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const workflow_r30 = ctx.$implicit;\n    const ctx_r29 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", workflow_r30.name, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", workflow_r30.prompt, \" \");\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r29.taskWorkflowNameMap.get(workflow_r30));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r29.runningTask && (ctx_r29.runningTask.workflowID !== workflow_r30.workflowID || ctx_r29.runningTaskGroupStatus !== ctx_r29.GroupTaskStatus.ACTIVE) || !ctx_r29.runningTask);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r29.runningTask && ctx_r29.runningTask.workflowID === workflow_r30.workflowID && ctx_r29.runningTaskGroupStatus === ctx_r29.GroupTaskStatus.ACTIVE);\n  }\n}\nfunction CkMonitorComponent_mat_sidenav_3_ng_container_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, CkMonitorComponent_mat_sidenav_3_ng_container_15_mat_list_item_1_Template, 13, 5, \"mat-list-item\", 21);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r14 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r14.activeTaskWorkflows);\n  }\n}\nfunction CkMonitorComponent_mat_sidenav_3_ng_container_21_mat_list_item_1_span_9_span_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const group_r47 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", group_r47.groupName, \"\\u00A0 \");\n  }\n}\nfunction CkMonitorComponent_mat_sidenav_3_ng_container_21_mat_list_item_1_span_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtemplate(1, CkMonitorComponent_mat_sidenav_3_ng_container_21_mat_list_item_1_span_9_span_1_Template, 2, 1, \"span\", 4);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const group_r47 = ctx.$implicit;\n    const ctx_r44 = i0.ɵɵnextContext(4);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", group_r47.groupStatus === ctx_r44.GroupTaskStatus.COMPLETE);\n  }\n}\nfunction CkMonitorComponent_mat_sidenav_3_ng_container_21_mat_list_item_1_button_11_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r52 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 26);\n    i0.ɵɵlistener(\"click\", function CkMonitorComponent_mat_sidenav_3_ng_container_21_mat_list_item_1_button_11_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r52);\n      const workflow_r43 = i0.ɵɵnextContext().$implicit;\n      const ctx_r50 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r50.view(workflow_r43, ctx_r50.GroupTaskStatus.COMPLETE));\n    });\n    i0.ɵɵtext(1, \" Monitor Task \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CkMonitorComponent_mat_sidenav_3_ng_container_21_mat_list_item_1_button_12_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r54 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 26);\n    i0.ɵɵlistener(\"click\", function CkMonitorComponent_mat_sidenav_3_ng_container_21_mat_list_item_1_button_12_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r54);\n      const ctx_r53 = i0.ɵɵnextContext(4);\n      return i0.ɵɵresetView(ctx_r53.close());\n    });\n    i0.ɵɵtext(1, \" Hide Task \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CkMonitorComponent_mat_sidenav_3_ng_container_21_mat_list_item_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-list-item\")(1, \"mat-icon\", 22);\n    i0.ɵɵtext(2, \"timeline\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"h3\", 23);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"p\", 24);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"p\", 24);\n    i0.ɵɵtext(8, \" Groups: \");\n    i0.ɵɵtemplate(9, CkMonitorComponent_mat_sidenav_3_ng_container_21_mat_list_item_1_span_9_Template, 2, 1, \"span\", 21);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(10, \"span\", 10);\n    i0.ɵɵtemplate(11, CkMonitorComponent_mat_sidenav_3_ng_container_21_mat_list_item_1_button_11_Template, 2, 0, \"button\", 25);\n    i0.ɵɵtemplate(12, CkMonitorComponent_mat_sidenav_3_ng_container_21_mat_list_item_1_button_12_Template, 2, 0, \"button\", 25);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const workflow_r43 = ctx.$implicit;\n    const ctx_r42 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", workflow_r43.name, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", workflow_r43.prompt, \" \");\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r42.taskWorkflowNameMap.get(workflow_r43));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r42.runningTask && (ctx_r42.runningTask.workflowID !== workflow_r43.workflowID || ctx_r42.runningTaskGroupStatus !== ctx_r42.GroupTaskStatus.COMPLETE) || !ctx_r42.runningTask);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r42.runningTask && ctx_r42.runningTask.workflowID === workflow_r43.workflowID && ctx_r42.runningTaskGroupStatus === ctx_r42.GroupTaskStatus.COMPLETE);\n  }\n}\nfunction CkMonitorComponent_mat_sidenav_3_ng_container_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, CkMonitorComponent_mat_sidenav_3_ng_container_21_mat_list_item_1_Template, 13, 5, \"mat-list-item\", 21);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r15 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r15.completeTaskWorkflows);\n  }\n}\nconst _c0 = function () {\n  return {\n    \"padding-bottom\": \"64px\"\n  };\n};\nfunction CkMonitorComponent_mat_sidenav_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r56 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"mat-sidenav\", 15, 16)(2, \"h2\", 17);\n    i0.ɵɵtext(3, \"All Tasks\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"mat-list\")(5, \"button\", 18);\n    i0.ɵɵlistener(\"click\", function CkMonitorComponent_mat_sidenav_3_Template_button_click_5_listener() {\n      i0.ɵɵrestoreView(_r56);\n      const ctx_r55 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r55.showInactive = !ctx_r55.showInactive);\n    });\n    i0.ɵɵtext(6);\n    i0.ɵɵelementStart(7, \"mat-icon\");\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(9, CkMonitorComponent_mat_sidenav_3_ng_container_9_Template, 2, 1, \"ng-container\", 4);\n    i0.ɵɵelement(10, \"mat-divider\");\n    i0.ɵɵelementStart(11, \"button\", 18);\n    i0.ɵɵlistener(\"click\", function CkMonitorComponent_mat_sidenav_3_Template_button_click_11_listener() {\n      i0.ɵɵrestoreView(_r56);\n      const ctx_r57 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r57.showActive = !ctx_r57.showActive);\n    });\n    i0.ɵɵtext(12);\n    i0.ɵɵelementStart(13, \"mat-icon\");\n    i0.ɵɵtext(14);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(15, CkMonitorComponent_mat_sidenav_3_ng_container_15_Template, 2, 1, \"ng-container\", 4);\n    i0.ɵɵelement(16, \"mat-divider\");\n    i0.ɵɵelementStart(17, \"button\", 18);\n    i0.ɵɵlistener(\"click\", function CkMonitorComponent_mat_sidenav_3_Template_button_click_17_listener() {\n      i0.ɵɵrestoreView(_r56);\n      const ctx_r58 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r58.showCompleted = !ctx_r58.showCompleted);\n    });\n    i0.ɵɵtext(18);\n    i0.ɵɵelementStart(19, \"mat-icon\");\n    i0.ɵɵtext(20);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(21, CkMonitorComponent_mat_sidenav_3_ng_container_21_Template, 2, 1, \"ng-container\", 4);\n    i0.ɵɵelement(22, \"mat-divider\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(23, \"div\", 19)(24, \"button\", 20);\n    i0.ɵɵlistener(\"click\", function CkMonitorComponent_mat_sidenav_3_Template_button_click_24_listener() {\n      i0.ɵɵrestoreView(_r56);\n      const ctx_r59 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r59.toggleTodos());\n    });\n    i0.ɵɵtext(25);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(26, \"button\", 20);\n    i0.ɵɵlistener(\"click\", function CkMonitorComponent_mat_sidenav_3_Template_button_click_26_listener() {\n      i0.ɵɵrestoreView(_r56);\n      const ctx_r60 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r60.toggleModels());\n    });\n    i0.ɵɵtext(27);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"fixedInViewport\", !ctx_r1.embedded ? true : false)(\"fixedTopGap\", 64)(\"ngStyle\", !ctx_r1.embedded && i0.ɵɵpureFunction0(14, _c0) || null);\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate1(\" Pending Tasks (\", ctx_r1.inactiveTaskWorkflows.length, \") \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r1.showInactive ? \"expand_less\" : \"expand_more\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.showInactive);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" Active Tasks (\", ctx_r1.activeTaskWorkflows.length, \") \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r1.showActive ? \"expand_less\" : \"expand_more\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.showActive);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" Completed Tasks (\", ctx_r1.completeTaskWorkflows.length, \") \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r1.showCompleted ? \"expand_less\" : \"expand_more\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.showCompleted);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.todoIsVisible ? \"Hide TODOs\" : \"View by TODOs\", \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.showModels ? \"Hide Learner Models\" : \"View Learner Models\", \" \");\n  }\n}\nfunction CkMonitorComponent_div_5_mat_error_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \"Invalid start date\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CkMonitorComponent_div_5_mat_error_20_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \"Invalid end date\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CkMonitorComponent_div_5_th_23_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 53);\n    i0.ɵɵtext(1, \" Student/Group \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CkMonitorComponent_div_5_td_24_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 54);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const element_r80 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", element_r80.name, \" \");\n  }\n}\nfunction CkMonitorComponent_div_5_th_26_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 55);\n    i0.ɵɵtext(1, \" Goal \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CkMonitorComponent_div_5_td_27_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 54);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const element_r81 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", element_r81.goal, \" \");\n  }\n}\nfunction CkMonitorComponent_div_5_th_29_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 56);\n    i0.ɵɵtext(1, \" Type \");\n    i0.ɵɵelementEnd();\n  }\n}\nconst _c1 = function (a0) {\n  return {\n    \"background-color\": a0,\n    \"margin\": \"2px\"\n  };\n};\nfunction CkMonitorComponent_div_5_td_30_mat_chip_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-chip\", 58);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const type_r84 = ctx.$implicit;\n    const ctx_r83 = i0.ɵɵnextContext(3);\n    i0.ɵɵproperty(\"ngStyle\", i0.ɵɵpureFunction1(2, _c1, ctx_r83.todoItemColors[type_r84]));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r83.todoItemTypes[type_r84], \" \");\n  }\n}\nfunction CkMonitorComponent_div_5_td_30_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 54)(1, \"mat-chip-list\");\n    i0.ɵɵtemplate(2, CkMonitorComponent_div_5_td_30_mat_chip_2_Template, 2, 4, \"mat-chip\", 57);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const element_r82 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", element_r82.types);\n  }\n}\nfunction CkMonitorComponent_div_5_th_32_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 59);\n    i0.ɵɵtext(1, \" Status \");\n    i0.ɵɵelementEnd();\n  }\n}\nconst _c2 = function (a0) {\n  return {\n    \"color\": a0\n  };\n};\nfunction CkMonitorComponent_div_5_td_33_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 60);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const element_r85 = ctx.$implicit;\n    i0.ɵɵproperty(\"ngStyle\", i0.ɵɵpureFunction1(2, _c2, element_r85.overdue ? \"red\" : element_r85.completed ? \"green\" : \"orange\"));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", element_r85.status, \" \");\n  }\n}\nfunction CkMonitorComponent_div_5_th_35_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 61);\n    i0.ɵɵtext(1, \" Deadline \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CkMonitorComponent_div_5_td_36_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 54);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const element_r86 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", element_r86.deadline, \" \");\n  }\n}\nfunction CkMonitorComponent_div_5_th_38_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 56);\n    i0.ɵɵtext(1, \" Completion Quality \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CkMonitorComponent_div_5_td_39_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 54);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const element_r87 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", element_r87.quality, \" \");\n  }\n}\nfunction CkMonitorComponent_div_5_th_41_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 56);\n    i0.ɵɵtext(1, \" Completion Notes \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CkMonitorComponent_div_5_td_42_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 54);\n    i0.ɵɵtext(1, \" TBD \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CkMonitorComponent_div_5_tr_43_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"tr\", 62);\n  }\n}\nfunction CkMonitorComponent_div_5_tr_44_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r91 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\", 63);\n    i0.ɵɵlistener(\"click\", function CkMonitorComponent_div_5_tr_44_Template_tr_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r91);\n      const row_r89 = restoredCtx.$implicit;\n      const ctx_r90 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r90.openTodoItemViewModal(row_r89));\n    });\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CkMonitorComponent_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r93 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 27)(1, \"mat-form-field\", 28)(2, \"mat-label\");\n    i0.ɵɵtext(3, \"Enter a date range\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"mat-date-range-input\", 29)(5, \"input\", 30);\n    i0.ɵɵlistener(\"dateChange\", function CkMonitorComponent_div_5_Template_input_dateChange_5_listener() {\n      i0.ɵɵrestoreView(_r93);\n      const ctx_r92 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r92.filterTodosByDeadline(ctx_r92.todoDeadlineRange.value.start, ctx_r92.todoDeadlineRange.value.end));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"input\", 31);\n    i0.ɵɵlistener(\"dateChange\", function CkMonitorComponent_div_5_Template_input_dateChange_6_listener() {\n      i0.ɵɵrestoreView(_r93);\n      const ctx_r94 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r94.filterTodosByDeadline(ctx_r94.todoDeadlineRange.value.start, ctx_r94.todoDeadlineRange.value.end));\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelement(7, \"mat-datepicker-toggle\", 32);\n    i0.ɵɵelementStart(8, \"mat-hint\");\n    i0.ɵɵtext(9, \"MM/DD/YYYY - MM/DD/YYYY\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"mat-date-range-picker\", null, 33)(12, \"mat-date-range-picker-actions\")(13, \"button\", 34);\n    i0.ɵɵlistener(\"click\", function CkMonitorComponent_div_5_Template_button_click_13_listener() {\n      i0.ɵɵrestoreView(_r93);\n      const ctx_r95 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r95.clearTodoFilter());\n    });\n    i0.ɵɵtext(14, \" Clear \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"button\", 35);\n    i0.ɵɵlistener(\"click\", function CkMonitorComponent_div_5_Template_button_click_15_listener() {\n      i0.ɵɵrestoreView(_r93);\n      const ctx_r96 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r96.filterTodosByDeadline(ctx_r96.todoDeadlineRange.value.start, ctx_r96.todoDeadlineRange.value.end));\n    });\n    i0.ɵɵtext(16, \" Apply \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"button\", 35);\n    i0.ɵɵlistener(\"click\", function CkMonitorComponent_div_5_Template_button_click_17_listener() {\n      i0.ɵɵrestoreView(_r93);\n      const ctx_r97 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r97.setDefaultRange(ctx_r97.todoDeadlineRange.value.start, ctx_r97.todoDeadlineRange.value.end));\n    });\n    i0.ɵɵtext(18, \" Set as Default \");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵtemplate(19, CkMonitorComponent_div_5_mat_error_19_Template, 2, 0, \"mat-error\", 4);\n    i0.ɵɵtemplate(20, CkMonitorComponent_div_5_mat_error_20_Template, 2, 0, \"mat-error\", 4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(21, \"table\", 36);\n    i0.ɵɵelementContainerStart(22, 37);\n    i0.ɵɵtemplate(23, CkMonitorComponent_div_5_th_23_Template, 2, 0, \"th\", 38);\n    i0.ɵɵtemplate(24, CkMonitorComponent_div_5_td_24_Template, 2, 1, \"td\", 39);\n    i0.ɵɵelementContainerEnd();\n    i0.ɵɵelementContainerStart(25, 40);\n    i0.ɵɵtemplate(26, CkMonitorComponent_div_5_th_26_Template, 2, 0, \"th\", 41);\n    i0.ɵɵtemplate(27, CkMonitorComponent_div_5_td_27_Template, 2, 1, \"td\", 39);\n    i0.ɵɵelementContainerEnd();\n    i0.ɵɵelementContainerStart(28, 42);\n    i0.ɵɵtemplate(29, CkMonitorComponent_div_5_th_29_Template, 2, 0, \"th\", 43);\n    i0.ɵɵtemplate(30, CkMonitorComponent_div_5_td_30_Template, 3, 1, \"td\", 39);\n    i0.ɵɵelementContainerEnd();\n    i0.ɵɵelementContainerStart(31, 44);\n    i0.ɵɵtemplate(32, CkMonitorComponent_div_5_th_32_Template, 2, 0, \"th\", 45);\n    i0.ɵɵtemplate(33, CkMonitorComponent_div_5_td_33_Template, 2, 4, \"td\", 46);\n    i0.ɵɵelementContainerEnd();\n    i0.ɵɵelementContainerStart(34, 47);\n    i0.ɵɵtemplate(35, CkMonitorComponent_div_5_th_35_Template, 2, 0, \"th\", 48);\n    i0.ɵɵtemplate(36, CkMonitorComponent_div_5_td_36_Template, 2, 1, \"td\", 39);\n    i0.ɵɵelementContainerEnd();\n    i0.ɵɵelementContainerStart(37, 49);\n    i0.ɵɵtemplate(38, CkMonitorComponent_div_5_th_38_Template, 2, 0, \"th\", 43);\n    i0.ɵɵtemplate(39, CkMonitorComponent_div_5_td_39_Template, 2, 1, \"td\", 39);\n    i0.ɵɵelementContainerEnd();\n    i0.ɵɵelementContainerStart(40, 50);\n    i0.ɵɵtemplate(41, CkMonitorComponent_div_5_th_41_Template, 2, 0, \"th\", 43);\n    i0.ɵɵtemplate(42, CkMonitorComponent_div_5_td_42_Template, 2, 0, \"td\", 39);\n    i0.ɵɵelementContainerEnd();\n    i0.ɵɵtemplate(43, CkMonitorComponent_div_5_tr_43_Template, 1, 0, \"tr\", 51);\n    i0.ɵɵtemplate(44, CkMonitorComponent_div_5_tr_44_Template, 1, 0, \"tr\", 52);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const _r61 = i0.ɵɵreference(11);\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"formGroup\", ctx_r2.todoDeadlineRange)(\"rangePicker\", _r61);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"for\", _r61);\n    i0.ɵɵadvance(12);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.todoDeadlineRange.controls.start.hasError(\"matStartDateInvalid\"));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.todoDeadlineRange.controls.end.hasError(\"matEndDateInvalid\"));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"dataSource\", ctx_r2.todoDataSource);\n    i0.ɵɵadvance(22);\n    i0.ɵɵproperty(\"matHeaderRowDef\", ctx_r2.todoColumns);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"matRowDefColumns\", ctx_r2.todoColumns);\n  }\n}\nfunction CkMonitorComponent_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵelement(1, \"app-learner-models\", 64, 65);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"board\", ctx_r3.board)(\"project\", ctx_r3.project)(\"studentView\", ctx_r3.studentView);\n  }\n}\nfunction CkMonitorComponent_mat_progress_bar_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"mat-progress-bar\", 66);\n  }\n}\nfunction CkMonitorComponent_div_8_mat_progress_bar_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"mat-progress-bar\", 69);\n  }\n}\nfunction CkMonitorComponent_div_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 67);\n    i0.ɵɵtext(1, \" No task selected! \");\n    i0.ɵɵtemplate(2, CkMonitorComponent_div_8_mat_progress_bar_2_Template, 1, 0, \"mat-progress-bar\", 68);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r5.loading);\n  }\n}\nfunction CkMonitorComponent_div_10_th_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 56);\n    i0.ɵɵtext(1, \" Group Name \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CkMonitorComponent_div_10_td_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 54);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const group_r110 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", group_r110.groupName, \" \");\n  }\n}\nfunction CkMonitorComponent_div_10_th_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 56);\n    i0.ɵɵtext(1, \" Members \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CkMonitorComponent_div_10_td_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 54);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const group_r111 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", group_r111.groupMembers.join(\", \"), \"\");\n  }\n}\nfunction CkMonitorComponent_div_10_th_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 56);\n    i0.ɵɵtext(1, \" Progress \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CkMonitorComponent_div_10_td_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 54);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const group_r112 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", group_r112.progress, \" % \");\n  }\n}\nfunction CkMonitorComponent_div_10_th_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 56);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r106 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r106.runningTaskGroupStatus === ctx_r106.GroupTaskStatus.INACTIVE ? \"\" : \"Action\", \" \");\n  }\n}\nfunction CkMonitorComponent_div_10_td_17_button_1_mat_icon_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-icon\", 82);\n    i0.ɵɵtext(1, \" play_circle_outline \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CkMonitorComponent_div_10_td_17_button_1_mat_icon_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-icon\", 83);\n    i0.ɵɵtext(1, \" cancel \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CkMonitorComponent_div_10_td_17_button_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r118 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 79);\n    i0.ɵɵlistener(\"click\", function CkMonitorComponent_div_10_td_17_button_1_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r118);\n      const group_r113 = i0.ɵɵnextContext().$implicit;\n      const ctx_r117 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r117.runningTaskGroupStatus === ctx_r117.GroupTaskStatus.COMPLETE ? ctx_r117.activateGroupTask(group_r113) : ctx_r117.completeGroupTask(group_r113));\n    });\n    i0.ɵɵtemplate(1, CkMonitorComponent_div_10_td_17_button_1_mat_icon_1_Template, 2, 0, \"mat-icon\", 80);\n    i0.ɵɵtemplate(2, CkMonitorComponent_div_10_td_17_button_1_mat_icon_2_Template, 2, 0, \"mat-icon\", 81);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r114 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r114.runningTaskGroupStatus === ctx_r114.GroupTaskStatus.COMPLETE);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r114.runningTaskGroupStatus === ctx_r114.GroupTaskStatus.ACTIVE);\n  }\n}\nfunction CkMonitorComponent_div_10_td_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 54);\n    i0.ɵɵtemplate(1, CkMonitorComponent_div_10_td_17_button_1_Template, 3, 2, \"button\", 78);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r107 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r107.runningTaskGroupStatus !== ctx_r107.GroupTaskStatus.INACTIVE);\n  }\n}\nfunction CkMonitorComponent_div_10_tr_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"tr\", 62);\n  }\n}\nfunction CkMonitorComponent_div_10_tr_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"tr\", 84);\n  }\n}\nfunction CkMonitorComponent_div_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\")(1, \"mat-card\", 70)(2, \"mat-card-title\");\n    i0.ɵɵtext(3, \"Task Progress\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\", 71)(5, \"table\", 72);\n    i0.ɵɵelementContainerStart(6, 73);\n    i0.ɵɵtemplate(7, CkMonitorComponent_div_10_th_7_Template, 2, 0, \"th\", 43);\n    i0.ɵɵtemplate(8, CkMonitorComponent_div_10_td_8_Template, 2, 1, \"td\", 39);\n    i0.ɵɵelementContainerEnd();\n    i0.ɵɵelementContainerStart(9, 74);\n    i0.ɵɵtemplate(10, CkMonitorComponent_div_10_th_10_Template, 2, 0, \"th\", 43);\n    i0.ɵɵtemplate(11, CkMonitorComponent_div_10_td_11_Template, 2, 1, \"td\", 39);\n    i0.ɵɵelementContainerEnd();\n    i0.ɵɵelementContainerStart(12, 75);\n    i0.ɵɵtemplate(13, CkMonitorComponent_div_10_th_13_Template, 2, 0, \"th\", 43);\n    i0.ɵɵtemplate(14, CkMonitorComponent_div_10_td_14_Template, 2, 1, \"td\", 39);\n    i0.ɵɵelementContainerEnd();\n    i0.ɵɵelementContainerStart(15, 76);\n    i0.ɵɵtemplate(16, CkMonitorComponent_div_10_th_16_Template, 2, 1, \"th\", 43);\n    i0.ɵɵtemplate(17, CkMonitorComponent_div_10_td_17_Template, 2, 1, \"td\", 39);\n    i0.ɵɵelementContainerEnd();\n    i0.ɵɵtemplate(18, CkMonitorComponent_div_10_tr_18_Template, 1, 0, \"tr\", 51);\n    i0.ɵɵtemplate(19, CkMonitorComponent_div_10_tr_19_Template, 1, 0, \"tr\", 77);\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const ctx_r6 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"dataSource\", ctx_r6.runningTaskTableData);\n    i0.ɵɵadvance(13);\n    i0.ɵɵproperty(\"matHeaderRowDef\", ctx_r6.displayColumns);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"matRowDefColumns\", ctx_r6.displayColumns);\n  }\n}\nfunction CkMonitorComponent_div_11_li_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\");\n    i0.ɵɵtext(1, \"Comment on each post at least once!\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CkMonitorComponent_div_11_li_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\");\n    i0.ɵɵtext(1, \"Tag each post at least once!\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CkMonitorComponent_div_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\")(1, \"mat-card\", 85)(2, \"mat-card-title\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"mat-card-content\")(5, \"p\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"section\")(8, \"h5\");\n    i0.ɵɵtext(9, \"Actions Required:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"ul\", 86);\n    i0.ɵɵtemplate(11, CkMonitorComponent_div_11_li_11_Template, 2, 0, \"li\", 4);\n    i0.ɵɵtemplate(12, CkMonitorComponent_div_11_li_12_Template, 2, 0, \"li\", 4);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(13, \"div\", 87)(14, \"label\", 88);\n    i0.ɵɵtext(15, \"Max Progress\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(16, \"mat-progress-bar\", 89);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"div\", 87)(18, \"label\", 88);\n    i0.ɵɵtext(19, \"Avg Progress\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(20, \"mat-progress-bar\", 90);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(21, \"div\", 87)(22, \"label\", 88);\n    i0.ɵɵtext(23, \"Min Progress\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(24, \"mat-progress-bar\", 90);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r7 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(ctx_r7.runningTask.name);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\"\", ctx_r7.runningTask.prompt, \" \");\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngIf\", ctx_r7.hasCommentRequirement(ctx_r7.runningTask));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r7.hasTagRequirement(ctx_r7.runningTask));\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"value\", ctx_r7.maxGroupProgress);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"value\", ctx_r7.averageGroupProgress);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"value\", ctx_r7.minGroupProgress);\n  }\n}\nconst _c3 = function (a0, a1) {\n  return {\n    \"padding-top\": a0,\n    \"padding-bottom\": a1\n  };\n};\nSwiperCore.use([EffectCards]);\nclass TodoItemDisplay {}\nexport class CkMonitorComponent {\n  set matSort(sort) {\n    this.todoDataSource.sort = sort;\n  }\n  constructor(userService, projectService, boardService, postService, workflowService, groupService, socketService, snackbarService, todoItemService, learnerService, converters, router, activatedRoute, dialog) {\n    this.userService = userService;\n    this.projectService = projectService;\n    this.boardService = boardService;\n    this.postService = postService;\n    this.workflowService = workflowService;\n    this.groupService = groupService;\n    this.socketService = socketService;\n    this.snackbarService = snackbarService;\n    this.todoItemService = todoItemService;\n    this.learnerService = learnerService;\n    this.converters = converters;\n    this.router = router;\n    this.activatedRoute = activatedRoute;\n    this.dialog = dialog;\n    this.showInactive = false;\n    this.showActive = false;\n    this.showCompleted = false;\n    this.taskWorkflows = [];\n    this.inactiveTaskWorkflows = [];\n    this.activeTaskWorkflows = [];\n    this.completeTaskWorkflows = [];\n    this.taskWorkflowGroupMap = new Map();\n    this.taskWorkflowNameMap = new Map();\n    this.taskWorkflowGroupNameMap = new Map();\n    this.taskWorkflowCompleteGroupNameMap = new Map();\n    this.listeners = [];\n    this.posts = [];\n    this.members = [];\n    this.todoIsVisible = false;\n    this.todoItems = [];\n    this.todoDataSource = new MatTableDataSource();\n    this.todoItemColors = TODO_TYPE_COLORS;\n    this.todoItemTypes = EXPANDED_TODO_TYPE;\n    this.todoColumns = ['name', 'goal', 'type', 'status', 'deadline', 'completion-quality', 'completion-notes'];\n    this.todoDeadlineRange = new FormGroup({\n      start: new FormControl(null),\n      end: new FormControl(null)\n    });\n    this.Role = Role;\n    this.TaskActionType = TaskActionType;\n    this.GroupTaskStatus = GroupTaskStatus;\n    this.displayColumns = ['group-name', 'members', 'progress', 'action'];\n    this.loading = true;\n    this.embedded = false;\n    this.showModels = false;\n    this.studentView = false;\n    this.viewType = ViewType.MONITOR;\n    this.todoDataSource.sortingDataAccessor = (data, sortHeaderId) => {\n      switch (sortHeaderId) {\n        default:\n          {\n            return sorting.nestedCaseInsensitive(data, sortHeaderId);\n          }\n      }\n    };\n    this.activatedRoute.queryParams.subscribe(params => {\n      if (params.embedded === 'true') {\n        this.embedded = true;\n      }\n    });\n  }\n  ngOnInit() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      _this.user = _this.userService.user;\n      if (_this.user.role === Role.STUDENT) {\n        _this.studentView = true;\n        _this.loading = false;\n      }\n      yield _this.loadWorkspaceData();\n      if (_this.studentView) _this.showModels = true;\n    })();\n  }\n  loadWorkspaceData() {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      var _a, _b, _c, _d;\n      const map = _this2.activatedRoute.snapshot.paramMap;\n      let boardID, projectID;\n      if (map.has('boardID') && map.has('projectID')) {\n        boardID = (_a = _this2.activatedRoute.snapshot.paramMap.get('boardID')) !== null && _a !== void 0 ? _a : '';\n        projectID = (_b = _this2.activatedRoute.snapshot.paramMap.get('projectID')) !== null && _b !== void 0 ? _b : '';\n      } else {\n        return _this2.router.navigate(['error']);\n      }\n      _this2.board = yield _this2.boardService.get(boardID);\n      _this2.project = yield _this2.projectService.get(projectID);\n      if (!((_c = _this2.board.viewSettings) === null || _c === void 0 ? void 0 : _c.allowMonitor)) {\n        _this2.router.navigateByUrl(`project/${projectID}/board/${boardID}/${(_d = _this2.board.defaultView) === null || _d === void 0 ? void 0 : _d.toLowerCase()}`);\n      }\n      if (!_this2.studentView) yield _this2.updateWorkflowData(boardID, projectID);\n      _this2.socketService.connect(_this2.user.userID, _this2.board.boardID);\n      return true;\n    })();\n  }\n  updateWorkflowData(boardID, projectID) {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      const inactiveTaskWorkflows = [];\n      const completeTaskWorkflows = [];\n      const activeTaskWorkflows = [];\n      _this3.todoItems = yield _this3.todoItemService.getByProject(projectID, 'expanded');\n      if (_this3.board.defaultTodoDateRange) {\n        const start = new Date(_this3.board.defaultTodoDateRange.start);\n        const end = new Date(_this3.board.defaultTodoDateRange.end);\n        _this3.todoDeadlineRange.setValue({\n          start,\n          end\n        });\n        _this3.filterTodosByDeadline(start, end);\n      } else {\n        _this3.updateTodoItemDataSource();\n      }\n      _this3.group = yield _this3.groupService.getByProjectUser(projectID, _this3.user.userID);\n      _this3.taskWorkflows = yield _this3.workflowService.getActiveTasks(boardID);\n      for (let i = 0; i < _this3.taskWorkflows.length; i++) {\n        const groupTasks = yield _this3.workflowService.getGroupTasksByWorkflow(_this3.taskWorkflows[i].workflowID, 'expanded');\n        groupTasks.sort((a, b) => _this3._calcGroupProgress(a) > _this3._calcGroupProgress(b) ? -1 : 1);\n        _this3.taskWorkflowNameMap.set(_this3.taskWorkflows[i], groupTasks.map(group => {\n          return {\n            groupName: group.group.name,\n            groupStatus: group.groupTask.status\n          };\n        }));\n        _this3.taskWorkflowGroupMap.set(_this3.taskWorkflows[i], groupTasks);\n        _this3.taskWorkflowGroupNameMap.set(_this3.taskWorkflows[i], groupTasks.filter(group => group.groupTask.status != GroupTaskStatus.COMPLETE).map(group => group.group.name));\n        _this3.taskWorkflowCompleteGroupNameMap.set(_this3.taskWorkflows[i], groupTasks.filter(group => group.groupTask.status === GroupTaskStatus.COMPLETE).map(group => group.group.name));\n        let activeCount = 0,\n          completedCount = 0;\n        for (let i = 0; groupTasks && i < groupTasks.length; i++) {\n          activeCount += Number(groupTasks[i].groupTask.status == GroupTaskStatus.ACTIVE);\n          completedCount += Number(groupTasks[i].groupTask.status == GroupTaskStatus.COMPLETE);\n        }\n        if (activeCount + completedCount != groupTasks.length) inactiveTaskWorkflows.push(_this3.taskWorkflows[i]);\n        if (completedCount) completeTaskWorkflows.push(_this3.taskWorkflows[i]);\n        if (activeCount) activeTaskWorkflows.push(_this3.taskWorkflows[i]);\n      }\n      _this3.inactiveTaskWorkflows = inactiveTaskWorkflows;\n      _this3.completeTaskWorkflows = completeTaskWorkflows;\n      _this3.activeTaskWorkflows = activeTaskWorkflows;\n      _this3.loading = false;\n    })();\n  }\n  updateTodoItemDataSource() {\n    var _this4 = this;\n    return _asyncToGenerator(function* () {\n      const data = [];\n      for (const todoItem of _this4.todoItems) {\n        const item = todoItem.todoItem;\n        const date = new Date(`${item.deadline.date} ${item.deadline.time}`);\n        const formattedDate = date.toLocaleDateString('en-CA');\n        const currentDate = new Date();\n        const name = todoItem.group ? todoItem.group.name : todoItem.user.username;\n        const overdue = date < currentDate && !item.completed;\n        const todo = {\n          name: name,\n          goal: item.title,\n          deadline: formattedDate,\n          status: overdue ? 'Missed' : item.completed ? 'Complete' : 'Pending',\n          quality: item.quality ? EXPANDED_COMPLETION_QUALITY[item.quality] : '',\n          types: item.type,\n          completed: item.completed,\n          overdue: overdue,\n          todoItem: todoItem.todoItem\n        };\n        data.push(todo);\n      }\n      _this4.todoDataSource.data = data;\n    })();\n  }\n  clearTodoFilter() {\n    this.updateTodoItemDataSource();\n    this.todoDeadlineRange.reset();\n  }\n  filterTodosByDeadline(start, end) {\n    if (!start || !end) return;\n    this.updateTodoItemDataSource();\n    this.todoDataSource.data = this.todoDataSource.data.filter(item => {\n      const date = new Date(item.deadline);\n      const adjustedDate = new Date(date.getTime() + Math.abs(date.getTimezoneOffset() * 60000));\n      return adjustedDate <= end && adjustedDate >= start;\n    });\n  }\n  setDefaultRange(start, end) {\n    if (!start || !end) return;\n    this.filterTodosByDeadline(start, end);\n    const defaultTodoDateRange = {\n      start,\n      end\n    };\n    this.boardService.update(this.board.boardID, {\n      defaultTodoDateRange\n    });\n  }\n  view(task, status) {\n    var _this5 = this;\n    return _asyncToGenerator(function* () {\n      _this5.runningTask = task;\n      _this5.todoIsVisible = false;\n      _this5.runningTaskGroupStatus = status;\n      _this5.showModels = false;\n      const progressData = yield _this5._calcAverageProgress(_this5.taskWorkflowGroupMap.get(_this5.runningTask));\n      _this5.minGroupProgress = progressData[0];\n      _this5.averageGroupProgress = progressData[1];\n      _this5.maxGroupProgress = progressData[2];\n      yield _this5.updateRunningTaskDataSource(task, status);\n      _this5._startListening();\n    })();\n  }\n  updateRunningTaskDataSource(workflow, status) {\n    var _this6 = this;\n    return _asyncToGenerator(function* () {\n      const groupTasks = _this6.taskWorkflowGroupMap.get(workflow);\n      const groupTasksTableFormat = [];\n      if (groupTasks) {\n        for (let i = 0; i < groupTasks.length; i++) {\n          if (groupTasks[i].groupTask.status == status) {\n            const groupMembers = [];\n            for (let j = 0; j < groupTasks[i].group.members.length; j++) {\n              groupMembers.push((yield _this6.userService.getOneById(groupTasks[i].group.members[j])).username);\n            }\n            groupTasksTableFormat.push({\n              groupName: groupTasks[i].group.name,\n              progress: _this6._calcGroupProgress(groupTasks[i]).toFixed(2),\n              groupMembers: groupMembers,\n              groupTaskID: groupTasks[i].groupTask.groupTaskID,\n              workflowID: groupTasks[i].workflow.workflowID,\n              taskWorkflow: groupTasks[i].workflow,\n              groupTaskStatus: groupTasks[i].groupTask.status\n            });\n          }\n        }\n      }\n      _this6.runningTaskTableData = new MatTableDataSource(groupTasksTableFormat);\n    })();\n  }\n  activateGroupTask(_group) {\n    var _this7 = this;\n    return _asyncToGenerator(function* () {\n      _this7.loading = true;\n      const updatedGroupTask = yield _this7.workflowService.markGroupTaskActive(_group.groupTaskID);\n      yield _this7.updateWorkflowData(_this7.board.boardID, _this7.project.projectID);\n      _this7.runningTaskTableData.data = _this7.runningTaskTableData.data.filter(data => data.groupTaskID != _group.groupTaskID);\n      if (!_this7.runningTaskTableData.data.length) {\n        _this7.runningTask = null;\n      }\n    })();\n  }\n  completeGroupTask(_group) {\n    var _this8 = this;\n    return _asyncToGenerator(function* () {\n      _this8.loading = true;\n      const updatedGroupTask = yield _this8.workflowService.markGroupTaskComplete(_group.groupTaskID);\n      yield _this8.updateWorkflowData(_this8.board.boardID, _this8.project.projectID);\n      _this8.runningTaskTableData.data = _this8.runningTaskTableData.data.filter(data => data.groupTaskID != _group.groupTaskID);\n      if (!_this8.runningTaskTableData.data.length) {\n        _this8.runningTask = null;\n      }\n    })();\n  }\n  close() {\n    this.runningTask = null;\n    this.runningTaskGroupStatus = null;\n    this.runningTaskTableData = new MatTableDataSource();\n    this.minGroupProgress = 0;\n    this.averageGroupProgress = 0;\n    this.maxGroupProgress = 0;\n    this.listeners.map(l => l.unsubscribe());\n  }\n  showBucketsModal() {\n    this._openDialog(BucketsModalComponent, {\n      board: this.board,\n      user: this.user,\n      allowMovePostToBoard: false\n    });\n  }\n  showListModal() {\n    this._openDialog(ListModalComponent, {\n      board: this.board\n    });\n  }\n  toggleModels() {\n    if (this.showModels) {\n      this.showModels = false;\n    } else {\n      this.todoIsVisible = false;\n      this.runningTask = null;\n      this.showModels = true;\n    }\n  }\n  toggleTodos() {\n    if (this.todoIsVisible) {\n      this.todoIsVisible = false;\n    } else {\n      this.showModels = false;\n      this.runningTask = null;\n      this.todoIsVisible = true;\n    }\n  }\n  openGroupDialog() {\n    this.dialog.open(ManageGroupModalComponent, {\n      data: {\n        project: this.project\n      }\n    });\n  }\n  hasCommentRequirement(runningTask) {\n    return runningTask.requiredActions.find(a => a.type == TaskActionType.COMMENT) != undefined;\n  }\n  hasTagRequirement(runningTask) {\n    return runningTask.requiredActions.find(a => a.type == TaskActionType.TAG) != undefined;\n  }\n  _startListening() {\n    var _this9 = this;\n    this.listeners.push(this.socketService.listen(SocketEvent.WORKFLOW_PROGRESS_UPDATE, /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator(function* (updates) {\n        const found = updates.find(u => {\n          var _a;\n          return u.workflow.workflowID == ((_a = _this9.runningTask) === null || _a === void 0 ? void 0 : _a.workflowID);\n        });\n        if (found) {\n          const groupTasks = yield _this9.workflowService.getGroupTasksByWorkflow(found.workflow.workflowID, 'expanded');\n          groupTasks.sort((a, b) => _this9._calcGroupProgress(a) > _this9._calcGroupProgress(b) ? -1 : 1);\n          _this9.taskWorkflowGroupMap.set(found.workflow, groupTasks);\n          _this9.runningTask = found.workflow;\n          _this9.runningTaskGroupStatus = GroupTaskStatus.ACTIVE;\n          const progressData = yield _this9._calcAverageProgress(groupTasks);\n          yield _this9.updateRunningTaskDataSource(found.workflow, GroupTaskStatus.ACTIVE);\n          _this9.minGroupProgress = progressData[0];\n          _this9.averageGroupProgress = progressData[1];\n          _this9.maxGroupProgress = progressData[2];\n        }\n      });\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }()));\n  }\n  copyEmbedCode() {\n    const url = window.location.href + '?embedded=true';\n    navigator.clipboard.writeText(url);\n  }\n  signOut() {\n    this.userService.logout();\n    this.router.navigate(['login']);\n  }\n  openTodoItemViewModal(rowElement) {\n    var _this10 = this;\n    return _asyncToGenerator(function* () {\n      _this10.dialog.open(TodoItemCardModalComponent, {\n        width: '500px',\n        data: {\n          todoItem: rowElement.todoItem,\n          projectID: _this10.project.projectID,\n          userID: _this10.user.userID,\n          group: rowElement.todoItem.groupID ? yield _this10.groupService.getById(rowElement.todoItem.groupID) : null,\n          onComplete: function () {\n            var _ref2 = _asyncToGenerator(function* (t) {\n              _this10.todoItems = yield _this10.todoItemService.getByProject(_this10.project.projectID, 'expanded');\n              _this10.updateTodoItemDataSource();\n            });\n            return function onComplete(_x2) {\n              return _ref2.apply(this, arguments);\n            };\n          }(),\n          onEdit: function () {\n            var _ref3 = _asyncToGenerator(function* (t) {\n              _this10.todoItems = yield _this10.todoItemService.getByProject(_this10.project.projectID, 'expanded');\n              _this10.updateTodoItemDataSource();\n            });\n            return function onEdit(_x3) {\n              return _ref3.apply(this, arguments);\n            };\n          }(),\n          onRestore: function () {\n            var _ref4 = _asyncToGenerator(function* (t) {\n              _this10.todoItems = yield _this10.todoItemService.getByProject(_this10.project.projectID, 'expanded');\n              _this10.updateTodoItemDataSource();\n            });\n            return function onRestore(_x4) {\n              return _ref4.apply(this, arguments);\n            };\n          }()\n        }\n      });\n    })();\n  }\n  ngOnDestroy() {\n    this.listeners.map(l => l.unsubscribe());\n    this.socketService.disconnect(this.user.userID, this.board.boardID);\n  }\n  _calcGroupProgress(task) {\n    if (!task) return 0;\n    // get all posts' progress\n    const values = Object.keys(task.groupTask.progress).map(function (key) {\n      return task.groupTask.progress[key];\n    });\n    // sum all amountRequired for each action per post\n    // i.e. Post A (1 tag req, 1 comment req) + Post B (1 tag req, 0 comments required)\n    const remaining = values.reduce((partialSum, a) => partialSum + a.reduce((partial, b) => partial + b.amountRequired, 0), 0);\n    // nothing left to do\n    if (remaining == 0) return 100;\n    // sum both required tags (1) and required comments (1) = 2\n    // multiple by number of posts since those requirements are per-post\n    const total = task.workflow.requiredActions.reduce((partialSum, a) => partialSum + a.amountRequired, 0) * values.length;\n    return (total - remaining) / total * 100;\n  }\n  _calcAverageProgress(tasks) {\n    var _this11 = this;\n    return _asyncToGenerator(function* () {\n      if (!tasks) return [0, 0, 0];\n      let totalProgress = 0;\n      let _min = Infinity;\n      let _max = -1 * Infinity;\n      for (let i = 0; i < tasks.length; i++) {\n        const groupProgress = _this11._calcGroupProgress(tasks[i]);\n        _min = Math.min(_min, groupProgress);\n        _max = Math.max(_max, groupProgress);\n        totalProgress += groupProgress;\n      }\n      return [_min, totalProgress / tasks.length, _max];\n    })();\n  }\n  _openDialog(component, data) {\n    this.dialog.open(component, {\n      maxWidth: 1280,\n      width: '95vw',\n      autoFocus: false,\n      data: data\n    });\n  }\n}\nCkMonitorComponent.ɵfac = function CkMonitorComponent_Factory(t) {\n  return new (t || CkMonitorComponent)(i0.ɵɵdirectiveInject(i1.UserService), i0.ɵɵdirectiveInject(i2.ProjectService), i0.ɵɵdirectiveInject(i3.BoardService), i0.ɵɵdirectiveInject(i4.PostService), i0.ɵɵdirectiveInject(i5.WorkflowService), i0.ɵɵdirectiveInject(i6.GroupService), i0.ɵɵdirectiveInject(i7.SocketService), i0.ɵɵdirectiveInject(i8.SnackbarService), i0.ɵɵdirectiveInject(i9.TodoItemService), i0.ɵɵdirectiveInject(i10.LearnerService), i0.ɵɵdirectiveInject(Converters), i0.ɵɵdirectiveInject(i11.Router), i0.ɵɵdirectiveInject(i11.ActivatedRoute), i0.ɵɵdirectiveInject(i12.MatDialog));\n};\nCkMonitorComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: CkMonitorComponent,\n  selectors: [[\"app-ck-monitor\"]],\n  viewQuery: function CkMonitorComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(SwiperComponent, 5);\n      i0.ɵɵviewQuery(MatSort, 5);\n    }\n    if (rf & 2) {\n      let _t;\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.swiper = _t.first);\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.matSort = _t.first);\n    }\n  },\n  decls: 12,\n  vars: 12,\n  consts: [[\"class\", \"toolbar\", 3, \"user\", \"embedded\", 4, \"ngIf\"], [1, \"drawer-container\", 3, \"ngStyle\"], [\"mode\", \"side\", \"opened\", \"\", \"style\", \"position: fixed\", 3, \"fixedInViewport\", \"fixedTopGap\", \"ngStyle\", 4, \"ngIf\"], [\"style\", \"margin: 10px\", 4, \"ngIf\"], [4, \"ngIf\"], [\"style\", \"margin: 20px; width: 95%\", \"mode\", \"indeterminate\", 4, \"ngIf\"], [\"class\", \"heading no-workflow-select\", 4, \"ngIf\"], [2, \"display\", \"flex\", \"flex-direction\", \"row\"], [1, \"toolbar\", 3, \"user\", \"embedded\"], [\"mat-icon-button\", \"\", \"matTooltip\", \"Copy embeddable URL\", 3, \"click\", 4, \"ngIf\"], [2, \"flex\", \"1 1 auto\"], [\"mat-icon-button\", \"\", \"matTooltip\", \"Back to Board\", 3, \"routerLink\"], [3, \"boardID\", \"currentView\"], [\"navbarMenu\", \"\", 3, \"board\", \"project\"], [\"mat-icon-button\", \"\", \"matTooltip\", \"Copy embeddable URL\", 3, \"click\"], [\"mode\", \"side\", \"opened\", \"\", 2, \"position\", \"fixed\", 3, \"fixedInViewport\", \"fixedTopGap\", \"ngStyle\"], [\"drawer\", \"\"], [1, \"section-title\"], [\"mat-button\", \"\", 1, \"subheader-button\", 3, \"click\"], [1, \"feature-buttons\"], [\"mat-raised-button\", \"\", \"color\", \"primary\", 3, \"click\"], [4, \"ngFor\", \"ngForOf\"], [\"matListIcon\", \"\"], [\"matLine\", \"\"], [\"matLine\", \"\", 1, \"list-task-prompt\"], [\"mat-raised-button\", \"\", \"color\", \"primary\", \"class\", \"sidebar-button\", 3, \"click\", 4, \"ngIf\"], [\"mat-raised-button\", \"\", \"color\", \"primary\", 1, \"sidebar-button\", 3, \"click\"], [2, \"margin\", \"10px\"], [\"appearance\", \"fill\", 2, \"float\", \"right\", \"margin-bottom\", \"10px\"], [3, \"formGroup\", \"rangePicker\"], [\"matStartDate\", \"\", \"formControlName\", \"start\", \"placeholder\", \"Start date\", 3, \"dateChange\"], [\"matEndDate\", \"\", \"formControlName\", \"end\", \"placeholder\", \"End date\", 3, \"dateChange\"], [\"matSuffix\", \"\", 3, \"for\"], [\"picker\", \"\"], [\"mat-button\", \"\", \"matDatepickerCancel\", \"\", 3, \"click\"], [\"mat-raised-button\", \"\", \"color\", \"primary\", \"matDateRangePickerApply\", \"\", 3, \"click\"], [\"mat-table\", \"\", \"matSort\", \"\", \"matSortActive\", \"deadline\", \"matSortDirection\", \"desc\", 1, \"table\", 3, \"dataSource\"], [\"matColumnDef\", \"name\"], [\"mat-header-cell\", \"\", \"mat-sort-header\", \"name\", 4, \"matHeaderCellDef\"], [\"mat-cell\", \"\", 4, \"matCellDef\"], [\"matColumnDef\", \"goal\"], [\"mat-header-cell\", \"\", \"mat-sort-header\", \"goal\", 4, \"matHeaderCellDef\"], [\"matColumnDef\", \"type\"], [\"mat-header-cell\", \"\", 4, \"matHeaderCellDef\"], [\"matColumnDef\", \"status\"], [\"mat-header-cell\", \"\", \"mat-sort-header\", \"status\", 4, \"matHeaderCellDef\"], [\"mat-cell\", \"\", \"style\", \"font-weight: 500\", 3, \"ngStyle\", 4, \"matCellDef\"], [\"matColumnDef\", \"deadline\"], [\"mat-header-cell\", \"\", \"mat-sort-header\", \"deadline\", 4, \"matHeaderCellDef\"], [\"matColumnDef\", \"completion-quality\"], [\"matColumnDef\", \"completion-notes\"], [\"mat-header-row\", \"\", 4, \"matHeaderRowDef\"], [\"mat-row\", \"\", \"class\", \"todoItemRow\", 3, \"click\", 4, \"matRowDef\", \"matRowDefColumns\"], [\"mat-header-cell\", \"\", \"mat-sort-header\", \"name\"], [\"mat-cell\", \"\"], [\"mat-header-cell\", \"\", \"mat-sort-header\", \"goal\"], [\"mat-header-cell\", \"\"], [3, \"ngStyle\", 4, \"ngFor\", \"ngForOf\"], [3, \"ngStyle\"], [\"mat-header-cell\", \"\", \"mat-sort-header\", \"status\"], [\"mat-cell\", \"\", 2, \"font-weight\", \"500\", 3, \"ngStyle\"], [\"mat-header-cell\", \"\", \"mat-sort-header\", \"deadline\"], [\"mat-header-row\", \"\"], [\"mat-row\", \"\", 1, \"todoItemRow\", 3, \"click\"], [3, \"board\", \"project\", \"studentView\"], [\"learner\", \"\"], [\"mode\", \"indeterminate\", 2, \"margin\", \"20px\", \"width\", \"95%\"], [1, \"heading\", \"no-workflow-select\"], [\"class\", \"mat-loading-progress-bar\", \"mode\", \"indeterminate\", 4, \"ngIf\"], [\"mode\", \"indeterminate\", 1, \"mat-loading-progress-bar\"], [2, \"margin\", \"7px\", \"padding\", \"16px 4px\"], [1, \"mat-elevation-z3\", \"table_style\"], [\"mat-table\", \"\", 1, \"table\", 3, \"dataSource\"], [\"matColumnDef\", \"group-name\"], [\"matColumnDef\", \"members\"], [\"matColumnDef\", \"progress\"], [\"matColumnDef\", \"action\"], [\"mat-row\", \"\", 4, \"matRowDef\", \"matRowDefColumns\"], [\"mat-icon-button\", \"\", 3, \"click\", 4, \"ngIf\"], [\"mat-icon-button\", \"\", 3, \"click\"], [\"matTooltip\", \"Re-activate Task\", 4, \"ngIf\"], [\"matTooltip\", \"Cancel Task\", 4, \"ngIf\"], [\"matTooltip\", \"Re-activate Task\"], [\"matTooltip\", \"Cancel Task\"], [\"mat-row\", \"\"], [1, \"example-card\", 2, \"width\", \"350px\", \"margin\", \"10px auto\"], [2, \"list-style-position\", \"inside\", \"padding-left\", \"0\", \"font-weight\", \"bold\"], [2, \"margin-bottom\", \"10px\"], [1, \"example-margin\"], [\"mode\", \"determinate\", 3, \"value\"], [\"mode\", \"determinate\", \"color\", \"accent\", 3, \"value\"]],\n  template: function CkMonitorComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\");\n      i0.ɵɵtemplate(1, CkMonitorComponent_app_toolbar_1_Template, 9, 9, \"app-toolbar\", 0);\n      i0.ɵɵelementStart(2, \"mat-sidenav-container\", 1);\n      i0.ɵɵtemplate(3, CkMonitorComponent_mat_sidenav_3_Template, 28, 15, \"mat-sidenav\", 2);\n      i0.ɵɵelementStart(4, \"mat-sidenav-content\");\n      i0.ɵɵtemplate(5, CkMonitorComponent_div_5_Template, 45, 8, \"div\", 3);\n      i0.ɵɵtemplate(6, CkMonitorComponent_div_6_Template, 3, 3, \"div\", 4);\n      i0.ɵɵtemplate(7, CkMonitorComponent_mat_progress_bar_7_Template, 1, 0, \"mat-progress-bar\", 5);\n      i0.ɵɵtemplate(8, CkMonitorComponent_div_8_Template, 3, 1, \"div\", 6);\n      i0.ɵɵelementStart(9, \"div\", 7);\n      i0.ɵɵtemplate(10, CkMonitorComponent_div_10_Template, 20, 3, \"div\", 4);\n      i0.ɵɵtemplate(11, CkMonitorComponent_div_11_Template, 25, 7, \"div\", 4);\n      i0.ɵɵelementEnd()()()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.user && ctx.project && ctx.board && !ctx.embedded);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngStyle\", i0.ɵɵpureFunction2(9, _c3, !ctx.embedded ? \"56px\" : \"0px\", ctx.embedded ? \"64px\" : \"0px\"));\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", !ctx.studentView);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", ctx.todoIsVisible);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.showModels);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.loading);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", !ctx.runningTask && !ctx.todoIsVisible && !ctx.showModels && !ctx.studentView);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", ctx.runningTask && !ctx.todoIsVisible);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.runningTask && !ctx.todoIsVisible);\n    }\n  },\n  styles: [\"var resource;\\n/******/ (() => { // webpackBootstrap\\n/******/ \\tvar __webpack_modules__ = ({\\n\\n/***/ 738:\\n/*!****************************************************************************!*\\\\\\n  !*** ./src/app/components/ck-monitor/ck-monitor.component.scss?ngResource ***!\\n  \\\\****************************************************************************/\\n/***/ (() => {\\n\\nthrow new Error(\\\"Module build failed (from ./node_modules/sass-loader/dist/cjs.js):\\\\nSassError: Can't find stylesheet to import.\\\\n  \\u2577\\\\n1 \\u2502 @import \\\\\\\"~swiper/css\\\\\\\";\\\\n  \\u2502         ^^^^^^^^^^^^^\\\\n  \\u2575\\\\n  src/app/components/ck-monitor/ck-monitor.component.scss 1:9  root stylesheet\\\");\\n\\n/***/ })\\n\\n/******/ \\t});\\n/************************************************************************/\\n/******/ \\t\\n/******/ \\t// startup\\n/******/ \\t// Load entry module and return exports\\n/******/ \\t// This entry module doesn't tell about it's top-level declarations so it can't be inlined\\n/******/ \\tvar __webpack_exports__ = {};\\n/******/ \\t__webpack_modules__[738]();\\n/******/ \\tresource = __webpack_exports__;\\n/******/ \\t\\n/******/ })()\\n;\"],\n  encapsulation: 2\n});","map":{"version":3,"mappings":"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","names":["ViewType","Role","TaskActionType","GroupTaskStatus","BucketsModalComponent","ListModalComponent","SwiperComponent","SwiperCore","EffectCards","Converters","EXPANDED_TODO_TYPE","SocketEvent","TODO_TYPE_COLORS","EXPANDED_COMPLETION_QUALITY","ManageGroupModalComponent","MatTableDataSource","MatSort","sorting","FormControl","FormGroup","TodoItemCardModalComponent","i0","ctx_r117","use","TodoItemDisplay","CkMonitorComponent","matSort","sort","todoDataSource","constructor","userService","projectService","boardService","postService","workflowService","groupService","socketService","snackbarService","todoItemService","learnerService","converters","router","activatedRoute","dialog","Map","start","end","MONITOR","sortingDataAccessor","data","sortHeaderId","nestedCaseInsensitive","queryParams","subscribe","params","embedded","ngOnInit","user","role","STUDENT","studentView","loading","loadWorkspaceData","showModels","map","snapshot","paramMap","boardID","projectID","has","get","navigate","board","project","viewSettings","allowMonitor","navigateByUrl","defaultView","toLowerCase","updateWorkflowData","connect","userID","inactiveTaskWorkflows","completeTaskWorkflows","activeTaskWorkflows","todoItems","getByProject","defaultTodoDateRange","Date","todoDeadlineRange","setValue","filterTodosByDeadline","updateTodoItemDataSource","group","getByProjectUser","taskWorkflows","getActiveTasks","i","length","groupTasks","getGroupTasksByWorkflow","workflowID","a","b","_calcGroupProgress","taskWorkflowNameMap","set","groupName","name","groupStatus","groupTask","status","taskWorkflowGroupMap","taskWorkflowGroupNameMap","filter","COMPLETE","taskWorkflowCompleteGroupNameMap","activeCount","completedCount","Number","ACTIVE","push","todoItem","item","date","deadline","time","formattedDate","toLocaleDateString","currentDate","username","overdue","completed","todo","goal","title","quality","types","type","clearTodoFilter","reset","adjustedDate","getTime","Math","abs","getTimezoneOffset","setDefaultRange","update","view","task","runningTask","todoIsVisible","runningTaskGroupStatus","progressData","_calcAverageProgress","minGroupProgress","averageGroupProgress","maxGroupProgress","updateRunningTaskDataSource","_startListening","workflow","groupTasksTableFormat","groupMembers","j","members","getOneById","progress","toFixed","groupTaskID","taskWorkflow","groupTaskStatus","runningTaskTableData","activateGroupTask","_group","updatedGroupTask","markGroupTaskActive","completeGroupTask","markGroupTaskComplete","close","listeners","l","unsubscribe","showBucketsModal","_openDialog","allowMovePostToBoard","showListModal","toggleModels","toggleTodos","openGroupDialog","open","hasCommentRequirement","requiredActions","find","COMMENT","undefined","hasTagRequirement","TAG","listen","WORKFLOW_PROGRESS_UPDATE","updates","found","u","copyEmbedCode","url","window","location","href","navigator","clipboard","writeText","signOut","logout","openTodoItemViewModal","rowElement","width","groupID","getById","onComplete","t","onEdit","onRestore","ngOnDestroy","disconnect","values","Object","keys","key","remaining","reduce","partialSum","partial","amountRequired","total","tasks","totalProgress","_min","Infinity","_max","groupProgress","min","max","component","maxWidth","autoFocus","selectors","viewQuery"],"sourceRoot":"","sources":["/Users/marieklinaeva/github/ck-board/frontend/src/app/components/ck-monitor/ck-monitor.component.ts","/Users/marieklinaeva/github/ck-board/frontend/src/app/components/ck-monitor/ck-monitor.component.html"],"sourcesContent":["import { ComponentType } from '@angular/cdk/overlay';\nimport {\n  Component,\n  OnDestroy,\n  OnInit,\n  ViewChild,\n  ViewEncapsulation,\n} from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { Board, BoardScope, ViewType } from 'src/app/models/board';\nimport { Project } from 'src/app/models/project';\nimport User, { AuthUser, Role } from 'src/app/models/user';\nimport {\n  ExpandedGroupTask,\n  TaskActionType,\n  TaskWorkflow,\n  GroupTaskStatus,\n} from 'src/app/models/workflow';\nimport { BoardService } from 'src/app/services/board.service';\nimport { ProjectService } from 'src/app/services/project.service';\nimport { SnackbarService } from 'src/app/services/snackbar.service';\nimport { UserService } from 'src/app/services/user.service';\nimport { WorkflowService } from 'src/app/services/workflow.service';\nimport { BucketsModalComponent } from '../buckets-modal/buckets-modal.component';\nimport { ListModalComponent } from '../list-modal/list-modal.component';\nimport { SwiperComponent } from 'swiper/angular';\nimport SwiperCore, { EffectCards } from 'swiper';\nimport { HTMLPost } from '../html-post/html-post.component';\nimport { Group } from 'src/app/models/group';\nimport { GroupService } from 'src/app/services/group.service';\nimport Converters from 'src/app/utils/converters';\nimport { PostService } from 'src/app/services/post.service';\nimport {\n  EXPANDED_TODO_TYPE,\n  SocketEvent,\n  TODO_TYPE_COLORS,\n  EXPANDED_COMPLETION_QUALITY,\n} from 'src/app/utils/constants';\nimport { SocketService } from 'src/app/services/socket.service';\nimport { Subscription } from 'rxjs';\nimport { ManageGroupModalComponent } from '../groups/manage-group-modal/manage-group-modal.component';\nimport { MatTableDataSource } from '@angular/material/table';\nimport {\n  CompletionQuality,\n  ExpandedTodoItem,\n  TodoItem,\n  TodoItemType,\n} from 'src/app/models/todoItem';\nimport { TodoItemService } from 'src/app/services/todoItem.service';\nimport { MatSort } from '@angular/material/sort';\nimport sorting from 'src/app/utils/sorting';\nimport { FormControl, FormGroup } from '@angular/forms';\nimport { TodoItemCardModalComponent } from '../todo-item-card-modal/todo-item-card-modal.component';\nimport { LearnerService } from 'src/app/services/learner.service';\n\nSwiperCore.use([EffectCards]);\n\ninterface MonitorData {\n  groupName: string;\n  groupMembers: string[];\n  groupTaskID: string;\n  progress: string;\n  workflowID: string;\n  taskWorkflow: TaskWorkflow;\n  groupTaskStatus: GroupTaskStatus;\n}\n\ninterface GroupName {\n  groupName: string;\n  groupStatus: GroupTaskStatus;\n}\n\nclass TodoItemDisplay {\n  name: string;\n  goal: string;\n  deadline: string;\n  status: string;\n  completed: boolean;\n  quality?: string;\n  overdue: boolean;\n  types: TodoItemType[];\n  todoItem: TodoItem;\n}\n\n@Component({\n  selector: 'app-ck-monitor',\n  templateUrl: './ck-monitor.component.html',\n  styleUrls: ['./ck-monitor.component.scss'],\n  encapsulation: ViewEncapsulation.None,\n})\nexport class CkMonitorComponent implements OnInit, OnDestroy {\n  @ViewChild(SwiperComponent) swiper: SwiperComponent;\n  @ViewChild(MatSort) set matSort(sort: MatSort) {\n    this.todoDataSource.sort = sort;\n  }\n\n  user: AuthUser;\n  group: Group;\n\n  project: Project;\n  board: Board;\n\n  showInactive = false;\n  showActive = false;\n  showCompleted = false;\n\n  taskWorkflows: TaskWorkflow[] = [];\n  inactiveTaskWorkflows: TaskWorkflow[] = [];\n  activeTaskWorkflows: TaskWorkflow[] = [];\n  completeTaskWorkflows: TaskWorkflow[] = [];\n\n  taskWorkflowGroupMap: Map<TaskWorkflow, ExpandedGroupTask[]> = new Map<\n    TaskWorkflow,\n    ExpandedGroupTask[]\n  >();\n\n  taskWorkflowNameMap: Map<TaskWorkflow, GroupName[]> = new Map<\n    TaskWorkflow,\n    GroupName[]\n  >();\n\n  taskWorkflowGroupNameMap: Map<TaskWorkflow, string[]> = new Map<\n    TaskWorkflow,\n    string[]\n  >();\n\n  taskWorkflowCompleteGroupNameMap: Map<TaskWorkflow, string[]> = new Map<\n    TaskWorkflow,\n    string[]\n  >();\n\n  runningTask: TaskWorkflow | null;\n  runningTaskGroupStatus: GroupTaskStatus | null;\n  runningTaskTableData: MatTableDataSource<MonitorData>;\n  currentGroupProgress: number;\n  averageGroupProgress: number;\n  maxGroupProgress: number;\n  minGroupProgress: number;\n  listeners: Subscription[] = [];\n  posts: HTMLPost[] = [];\n  members: User[] = [];\n\n  todoIsVisible: Boolean = false;\n  todoItems: ExpandedTodoItem[] = [];\n  todoDataSource = new MatTableDataSource<TodoItemDisplay>();\n  todoItemColors = TODO_TYPE_COLORS;\n  todoItemTypes = EXPANDED_TODO_TYPE;\n  todoColumns: string[] = [\n    'name',\n    'goal',\n    'type',\n    'status',\n    'deadline',\n    'completion-quality',\n    'completion-notes',\n  ];\n\n  todoDeadlineRange = new FormGroup({\n    start: new FormControl(null),\n    end: new FormControl(null),\n  });\n\n  Role: typeof Role = Role;\n  TaskActionType: typeof TaskActionType = TaskActionType;\n  GroupTaskStatus: typeof GroupTaskStatus = GroupTaskStatus;\n\n  displayColumns: string[] = ['group-name', 'members', 'progress', 'action'];\n  loading: boolean = true;\n  embedded: boolean = false;\n\n  showModels = false;\n\n  studentView = false;\n  viewType = ViewType.MONITOR;\n\n  constructor(\n    public userService: UserService,\n    public projectService: ProjectService,\n    public boardService: BoardService,\n    public postService: PostService,\n    public workflowService: WorkflowService,\n    public groupService: GroupService,\n    public socketService: SocketService,\n    public snackbarService: SnackbarService,\n    public todoItemService: TodoItemService,\n    public learnerService: LearnerService,\n    private converters: Converters,\n    private router: Router,\n    private activatedRoute: ActivatedRoute,\n    public dialog: MatDialog\n  ) {\n    this.todoDataSource.sortingDataAccessor = (data, sortHeaderId) => {\n      switch (sortHeaderId) {\n        default: {\n          return sorting.nestedCaseInsensitive(data, sortHeaderId);\n        }\n      }\n    };\n    this.activatedRoute.queryParams.subscribe((params) => {\n      if (params.embedded === 'true') {\n        this.embedded = true;\n      }\n    });\n  }\n\n  async ngOnInit(): Promise<void> {\n    this.user = this.userService.user!;\n    if (this.user.role === Role.STUDENT) {\n      this.studentView = true;\n      this.loading = false;\n    }\n    await this.loadWorkspaceData();\n    if (this.studentView) this.showModels = true;\n  }\n\n  async loadWorkspaceData(): Promise<boolean> {\n    const map = this.activatedRoute.snapshot.paramMap;\n    let boardID: string, projectID: string;\n\n    if (map.has('boardID') && map.has('projectID')) {\n      boardID = this.activatedRoute.snapshot.paramMap.get('boardID') ?? '';\n      projectID = this.activatedRoute.snapshot.paramMap.get('projectID') ?? '';\n    } else {\n      return this.router.navigate(['error']);\n    }\n\n    this.board = await this.boardService.get(boardID);\n    this.project = await this.projectService.get(projectID);\n\n    if (!this.board.viewSettings?.allowMonitor) {\n      this.router.navigateByUrl(\n        `project/${projectID}/board/${boardID}/${this.board.defaultView?.toLowerCase()}`\n      );\n    }\n\n    if (!this.studentView) await this.updateWorkflowData(boardID, projectID);\n    this.socketService.connect(this.user.userID, this.board.boardID);\n    return true;\n  }\n\n  async updateWorkflowData(boardID, projectID) {\n    const inactiveTaskWorkflows: TaskWorkflow[] = [];\n    const completeTaskWorkflows: TaskWorkflow[] = [];\n    const activeTaskWorkflows: TaskWorkflow[] = [];\n\n    this.todoItems = await this.todoItemService.getByProject(\n      projectID,\n      'expanded'\n    );\n    if (this.board.defaultTodoDateRange) {\n      const start = new Date(this.board.defaultTodoDateRange.start);\n      const end = new Date(this.board.defaultTodoDateRange.end);\n      this.todoDeadlineRange.setValue({ start, end });\n      this.filterTodosByDeadline(start, end);\n    } else {\n      this.updateTodoItemDataSource();\n    }\n    this.group = await this.groupService.getByProjectUser(\n      projectID,\n      this.user.userID\n    );\n\n    this.taskWorkflows = await this.workflowService.getActiveTasks(boardID);\n\n    for (let i = 0; i < this.taskWorkflows.length; i++) {\n      const groupTasks = await this.workflowService.getGroupTasksByWorkflow(\n        this.taskWorkflows[i].workflowID,\n        'expanded'\n      );\n      groupTasks.sort((a, b) =>\n        this._calcGroupProgress(a) > this._calcGroupProgress(b) ? -1 : 1\n      );\n      this.taskWorkflowNameMap.set(\n        this.taskWorkflows[i],\n        groupTasks.map((group) => {\n          return {\n            groupName: group.group.name,\n            groupStatus: group.groupTask.status,\n          };\n        })\n      );\n      this.taskWorkflowGroupMap.set(this.taskWorkflows[i], groupTasks);\n      this.taskWorkflowGroupNameMap.set(\n        this.taskWorkflows[i],\n        groupTasks\n          .filter((group) => group.groupTask.status != GroupTaskStatus.COMPLETE)\n          .map((group) => group.group.name)\n      );\n      this.taskWorkflowCompleteGroupNameMap.set(\n        this.taskWorkflows[i],\n        groupTasks\n          .filter(\n            (group) => group.groupTask.status === GroupTaskStatus.COMPLETE\n          )\n          .map((group) => group.group.name)\n      );\n      let activeCount = 0,\n        completedCount = 0;\n\n      for (let i = 0; groupTasks && i < groupTasks.length; i++) {\n        activeCount += Number(\n          groupTasks[i].groupTask.status == GroupTaskStatus.ACTIVE\n        );\n        completedCount += Number(\n          groupTasks[i].groupTask.status == GroupTaskStatus.COMPLETE\n        );\n      }\n\n      if (activeCount + completedCount != groupTasks.length)\n        inactiveTaskWorkflows.push(this.taskWorkflows[i]);\n      if (completedCount) completeTaskWorkflows.push(this.taskWorkflows[i]);\n      if (activeCount) activeTaskWorkflows.push(this.taskWorkflows[i]);\n    }\n    this.inactiveTaskWorkflows = inactiveTaskWorkflows;\n    this.completeTaskWorkflows = completeTaskWorkflows;\n    this.activeTaskWorkflows = activeTaskWorkflows;\n    this.loading = false;\n  }\n\n  async updateTodoItemDataSource(): Promise<void> {\n    const data: TodoItemDisplay[] = [];\n\n    for (const todoItem of this.todoItems) {\n      const item = todoItem.todoItem;\n      const date = new Date(`${item.deadline.date} ${item.deadline.time}`);\n      const formattedDate = date.toLocaleDateString('en-CA');\n      const currentDate = new Date();\n      const name = todoItem.group\n        ? todoItem.group.name\n        : todoItem.user.username;\n      const overdue = date < currentDate && !item.completed;\n      const todo: TodoItemDisplay = {\n        name: name,\n        goal: item.title,\n        deadline: formattedDate,\n        status: overdue ? 'Missed' : item.completed ? 'Complete' : 'Pending',\n        quality: item.quality ? EXPANDED_COMPLETION_QUALITY[item.quality] : '',\n        types: item.type,\n        completed: item.completed,\n        overdue: overdue,\n        todoItem: todoItem.todoItem,\n      };\n      data.push(todo);\n    }\n    this.todoDataSource.data = data;\n  }\n\n  clearTodoFilter(): void {\n    this.updateTodoItemDataSource();\n    this.todoDeadlineRange.reset();\n  }\n\n  filterTodosByDeadline(start: Date, end: Date): void {\n    if (!start || !end) return;\n    this.updateTodoItemDataSource();\n    this.todoDataSource.data = this.todoDataSource.data.filter((item) => {\n      const date = new Date(item.deadline);\n      const adjustedDate = new Date(\n        date.getTime() + Math.abs(date.getTimezoneOffset() * 60000)\n      );\n      return adjustedDate <= end && adjustedDate >= start;\n    });\n  }\n\n  setDefaultRange(start: Date, end: Date): void {\n    if (!start || !end) return;\n    this.filterTodosByDeadline(start, end);\n    const defaultTodoDateRange = { start, end };\n    this.boardService.update(this.board.boardID, { defaultTodoDateRange });\n  }\n\n  async view(task: TaskWorkflow, status: GroupTaskStatus): Promise<void> {\n    this.runningTask = task;\n    this.todoIsVisible = false;\n    this.runningTaskGroupStatus = status;\n    this.showModels = false;\n    const progressData = await this._calcAverageProgress(\n      this.taskWorkflowGroupMap.get(this.runningTask)\n    );\n    this.minGroupProgress = progressData[0];\n    this.averageGroupProgress = progressData[1];\n    this.maxGroupProgress = progressData[2];\n    await this.updateRunningTaskDataSource(task, status);\n    this._startListening();\n  }\n\n  async updateRunningTaskDataSource(\n    workflow: TaskWorkflow,\n    status: GroupTaskStatus\n  ): Promise<void> {\n    const groupTasks = this.taskWorkflowGroupMap.get(workflow);\n    const groupTasksTableFormat: MonitorData[] = [];\n    if (groupTasks) {\n      for (let i = 0; i < groupTasks.length; i++) {\n        if (groupTasks[i].groupTask.status == status) {\n          const groupMembers: string[] = [];\n          for (let j = 0; j < groupTasks[i].group.members.length; j++) {\n            groupMembers.push(\n              (\n                await this.userService.getOneById(\n                  groupTasks[i].group.members[j]\n                )\n              ).username\n            );\n          }\n          groupTasksTableFormat.push({\n            groupName: groupTasks[i].group.name,\n            progress: this._calcGroupProgress(groupTasks[i]).toFixed(2),\n            groupMembers: groupMembers,\n            groupTaskID: groupTasks[i].groupTask.groupTaskID,\n            workflowID: groupTasks[i].workflow.workflowID,\n            taskWorkflow: groupTasks[i].workflow,\n            groupTaskStatus: groupTasks[i].groupTask.status,\n          });\n        }\n      }\n    }\n    this.runningTaskTableData = new MatTableDataSource<MonitorData>(\n      groupTasksTableFormat\n    );\n  }\n\n  async activateGroupTask(_group: MonitorData) {\n    this.loading = true;\n    const updatedGroupTask = await this.workflowService.markGroupTaskActive(\n      _group.groupTaskID\n    );\n    await this.updateWorkflowData(this.board.boardID, this.project.projectID);\n    this.runningTaskTableData.data = this.runningTaskTableData.data.filter(\n      (data) => data.groupTaskID != _group.groupTaskID\n    );\n    if (!this.runningTaskTableData.data.length) {\n      this.runningTask = null;\n    }\n  }\n\n  async completeGroupTask(_group: MonitorData) {\n    this.loading = true;\n    const updatedGroupTask = await this.workflowService.markGroupTaskComplete(\n      _group.groupTaskID\n    );\n    await this.updateWorkflowData(this.board.boardID, this.project.projectID);\n    this.runningTaskTableData.data = this.runningTaskTableData.data.filter(\n      (data) => data.groupTaskID != _group.groupTaskID\n    );\n    if (!this.runningTaskTableData.data.length) {\n      this.runningTask = null;\n    }\n  }\n\n  close(): void {\n    this.runningTask = null;\n    this.runningTaskGroupStatus = null;\n    this.runningTaskTableData = new MatTableDataSource<MonitorData>();\n    this.minGroupProgress = 0;\n    this.averageGroupProgress = 0;\n    this.maxGroupProgress = 0;\n    this.listeners.map((l) => l.unsubscribe());\n  }\n\n  showBucketsModal(): void {\n    this._openDialog(BucketsModalComponent, {\n      board: this.board,\n      user: this.user,\n      allowMovePostToBoard: false,\n    });\n  }\n\n  showListModal(): void {\n    this._openDialog(ListModalComponent, {\n      board: this.board,\n    });\n  }\n\n  toggleModels(): void {\n    if (this.showModels) {\n      this.showModels = false;\n    } else {\n      this.todoIsVisible = false;\n      this.runningTask = null;\n      this.showModels = true;\n    }\n  }\n\n  toggleTodos(): void {\n    if (this.todoIsVisible) {\n      this.todoIsVisible = false;\n    } else {\n      this.showModels = false;\n      this.runningTask = null;\n      this.todoIsVisible = true;\n    }\n  }\n\n  openGroupDialog(): void {\n    this.dialog.open(ManageGroupModalComponent, {\n      data: {\n        project: this.project,\n      },\n    });\n  }\n\n  hasCommentRequirement(runningTask: TaskWorkflow): boolean {\n    return (\n      runningTask.requiredActions.find(\n        (a) => a.type == TaskActionType.COMMENT\n      ) != undefined\n    );\n  }\n\n  hasTagRequirement(runningTask: TaskWorkflow): boolean {\n    return (\n      runningTask.requiredActions.find((a) => a.type == TaskActionType.TAG) !=\n      undefined\n    );\n  }\n\n  private _startListening(): void {\n    this.listeners.push(\n      this.socketService.listen(\n        SocketEvent.WORKFLOW_PROGRESS_UPDATE,\n        async (updates) => {\n          const found = updates.find(\n            (u) => u.workflow.workflowID == this.runningTask?.workflowID\n          );\n          if (found) {\n            const groupTasks =\n              await this.workflowService.getGroupTasksByWorkflow(\n                found.workflow.workflowID,\n                'expanded'\n              );\n            groupTasks.sort((a, b) =>\n              this._calcGroupProgress(a) > this._calcGroupProgress(b) ? -1 : 1\n            );\n            this.taskWorkflowGroupMap.set(found.workflow, groupTasks);\n            this.runningTask = found.workflow;\n            this.runningTaskGroupStatus = GroupTaskStatus.ACTIVE;\n            const progressData = await this._calcAverageProgress(groupTasks);\n            await this.updateRunningTaskDataSource(\n              found.workflow,\n              GroupTaskStatus.ACTIVE\n            );\n            this.minGroupProgress = progressData[0];\n            this.averageGroupProgress = progressData[1];\n            this.maxGroupProgress = progressData[2];\n          }\n        }\n      )\n    );\n  }\n\n  copyEmbedCode() {\n    const url = window.location.href + '?embedded=true';\n    navigator.clipboard.writeText(url);\n  }\n\n  signOut(): void {\n    this.userService.logout();\n    this.router.navigate(['login']);\n  }\n\n  async openTodoItemViewModal(rowElement: TodoItemDisplay) {\n    this.dialog.open(TodoItemCardModalComponent, {\n      width: '500px',\n      data: {\n        todoItem: rowElement.todoItem,\n        projectID: this.project.projectID,\n        userID: this.user.userID,\n        group: rowElement.todoItem.groupID\n          ? await this.groupService.getById(rowElement.todoItem.groupID)\n          : null,\n        onComplete: async (t: TodoItem) => {\n          this.todoItems = await this.todoItemService.getByProject(\n            this.project.projectID,\n            'expanded'\n          );\n          this.updateTodoItemDataSource();\n        },\n        onEdit: async (t: TodoItem) => {\n          this.todoItems = await this.todoItemService.getByProject(\n            this.project.projectID,\n            'expanded'\n          );\n          this.updateTodoItemDataSource();\n        },\n        onRestore: async (t: TodoItem) => {\n          this.todoItems = await this.todoItemService.getByProject(\n            this.project.projectID,\n            'expanded'\n          );\n          this.updateTodoItemDataSource();\n        },\n      },\n    });\n  }\n\n  ngOnDestroy(): void {\n    this.listeners.map((l) => l.unsubscribe());\n    this.socketService.disconnect(this.user.userID, this.board.boardID);\n  }\n\n  private _calcGroupProgress(task: ExpandedGroupTask | null): number {\n    if (!task) return 0;\n\n    // get all posts' progress\n    const values = Object.keys(task.groupTask.progress).map(function (key) {\n      return task.groupTask.progress[key];\n    });\n\n    // sum all amountRequired for each action per post\n    // i.e. Post A (1 tag req, 1 comment req) + Post B (1 tag req, 0 comments required)\n    const remaining = values.reduce(\n      (partialSum, a) =>\n        partialSum + a.reduce((partial, b) => partial + b.amountRequired, 0),\n      0\n    );\n\n    // nothing left to do\n    if (remaining == 0) return 100;\n\n    // sum both required tags (1) and required comments (1) = 2\n    // multiple by number of posts since those requirements are per-post\n    const total =\n      task.workflow.requiredActions.reduce(\n        (partialSum, a) => partialSum + a.amountRequired,\n        0\n      ) * values.length;\n\n    return ((total - remaining) / total) * 100;\n  }\n\n  private async _calcAverageProgress(\n    tasks: ExpandedGroupTask[] | undefined\n  ): Promise<number[]> {\n    if (!tasks) return [0, 0, 0];\n    let totalProgress = 0;\n    let _min = Infinity;\n    let _max = -1 * Infinity;\n    for (let i = 0; i < tasks.length; i++) {\n      const groupProgress = this._calcGroupProgress(tasks[i]);\n      _min = Math.min(_min, groupProgress);\n      _max = Math.max(_max, groupProgress);\n      totalProgress += groupProgress;\n    }\n    return [_min, totalProgress / tasks.length, _max];\n  }\n\n  private _openDialog(component: ComponentType<unknown>, data: any) {\n    this.dialog.open(component, {\n      maxWidth: 1280,\n      width: '95vw',\n      autoFocus: false,\n      data: data,\n    });\n  }\n}\n","<div>\n  <app-toolbar class=\"toolbar\" *ngIf=\"user && project && board && !embedded\" [user]=\"user\" [embedded]=\"embedded\">\n    <span *ngIf=\"board\">CK Monitor - {{ this.board.name }}</span>\n    <button mat-icon-button *ngIf=\"user.role === Role.TEACHER\" (click)=\"copyEmbedCode()\" matTooltip=\"Copy embeddable URL\">\n        <mat-icon>file_copy</mat-icon>\n      </button>\n    <span style=\"flex: 1 1 auto\"></span>\n    \n    <button mat-icon-button routerLink=\"{{'/project/'+project.projectID+'/board/'+board.boardID}}\" matTooltip=\"Back to Board\">\n      <mat-icon>keyboard_return</mat-icon>\n    </button>\n    <app-view-navigation [boardID]=\"board.boardID\" [currentView]=\"viewType\"></app-view-navigation>\n    <app-toolbar-menu navbarMenu [board]=\"board\" [project]=\"project\"></app-toolbar-menu>\n  </app-toolbar>\n  <mat-sidenav-container class=\"drawer-container\" [ngStyle]=\"{'padding-top': !embedded ? '56px' : '0px', 'padding-bottom': embedded ? '64px' : '0px' }\">\n    <mat-sidenav #drawer mode=\"side\" opened [fixedInViewport]=\"!embedded ? true : false\" [fixedTopGap]=\"64\" style=\"position: fixed\" [ngStyle]=\"!embedded && {'padding-bottom': '64px' } || null\" *ngIf=\"!studentView\">\n      <h2 class=\"section-title\">All Tasks</h2>\n      <mat-list>\n        <button class=\"subheader-button\" mat-button (click)=\"showInactive = !showInactive\">\n          Pending Tasks ({{ inactiveTaskWorkflows.length }})\n          <mat-icon>{{ showInactive ? 'expand_less' : 'expand_more' }}</mat-icon>\n        </button>\n        <ng-container *ngIf=\"showInactive\">\n          <mat-list-item *ngFor=\"let workflow of inactiveTaskWorkflows\">\n            <mat-icon matListIcon>timeline</mat-icon>\n            <h3 matLine> {{workflow.name}} </h3>\n            <p matLine class=\"list-task-prompt\"> {{workflow.prompt}} </p>\n            <p matLine class=\"list-task-prompt\">\n              Groups:\n              <span *ngFor=\"let group of taskWorkflowNameMap.get(workflow)\">\n                <span *ngIf=\"group.groupStatus === GroupTaskStatus.INACTIVE\">\n                  {{group.groupName}}&nbsp;\n                </span>\n              </span>\n            </p>\n            <span style=\"flex: 1 1 auto\"></span>\n            <button\n              *ngIf=\"(runningTask && (runningTask.workflowID !== workflow.workflowID || runningTaskGroupStatus !== GroupTaskStatus.INACTIVE)) || (!runningTask)\"\n              mat-raised-button\n              color=\"primary\"\n              class=\"sidebar-button\"\n              (click)=\"view(workflow, GroupTaskStatus.INACTIVE)\"\n            >\n              Monitor Task\n            </button>\n            <button\n              *ngIf=\"runningTask && runningTask.workflowID === workflow.workflowID && runningTaskGroupStatus === GroupTaskStatus.INACTIVE\"\n              mat-raised-button\n              color=\"primary\"\n              class=\"sidebar-button\"\n              (click)=\"close()\"\n            >\n              Hide Task\n            </button>\n          </mat-list-item>\n        </ng-container>\n        <mat-divider></mat-divider>\n        <button class=\"subheader-button\" mat-button (click)=\"showActive = !showActive\">\n          Active Tasks ({{ activeTaskWorkflows.length }})\n          <mat-icon>{{ showActive ? 'expand_less' : 'expand_more' }}</mat-icon>\n        </button>\n        <ng-container *ngIf=\"showActive\">\n          <mat-list-item *ngFor=\"let workflow of activeTaskWorkflows\">\n            <mat-icon matListIcon>timeline</mat-icon>\n            <h3 matLine> {{workflow.name}} </h3>\n            <p matLine class=\"list-task-prompt\"> {{workflow.prompt}} </p>\n            <p matLine class=\"list-task-prompt\"> \n              Groups:\n              <span *ngFor=\"let group of taskWorkflowNameMap.get(workflow)\">\n                <span *ngIf=\"group.groupStatus === GroupTaskStatus.ACTIVE\">\n                  {{group.groupName}}&nbsp;\n                </span>\n              </span>\n            </p>\n            <span style=\"flex: 1 1 auto\"></span>\n            <button\n              *ngIf=\"(runningTask && (runningTask.workflowID !== workflow.workflowID || runningTaskGroupStatus !== GroupTaskStatus.ACTIVE)) || (!runningTask)\"\n              mat-raised-button\n              color=\"primary\"\n              class=\"sidebar-button\"\n              (click)=\"view(workflow, GroupTaskStatus.ACTIVE)\"\n            >\n              Monitor Task\n            </button>\n            <button\n              *ngIf=\"runningTask && runningTask.workflowID === workflow.workflowID && runningTaskGroupStatus === GroupTaskStatus.ACTIVE\"\n              mat-raised-button\n              color=\"primary\"\n              class=\"sidebar-button\"\n              (click)=\"close()\"\n            >\n              Hide Task\n            </button>\n          </mat-list-item>\n        </ng-container>\n        <mat-divider></mat-divider>\n        <button class=\"subheader-button\" mat-button (click)=\"showCompleted = !showCompleted\">\n          Completed Tasks ({{ completeTaskWorkflows.length }})\n          <mat-icon>{{ showCompleted ? 'expand_less' : 'expand_more' }}</mat-icon>\n        </button>\n        <ng-container *ngIf=\"showCompleted\">\n          <mat-list-item *ngFor=\"let workflow of completeTaskWorkflows\">\n            <mat-icon matListIcon>timeline</mat-icon>\n            <h3 matLine> {{workflow.name}} </h3>\n            <p matLine class=\"list-task-prompt\"> {{workflow.prompt}} </p>\n            <p matLine class=\"list-task-prompt\"> \n              Groups:\n              <span *ngFor=\"let group of taskWorkflowNameMap.get(workflow)\">\n                <span *ngIf=\"group.groupStatus === GroupTaskStatus.COMPLETE\">\n                  {{group.groupName}}&nbsp;\n                </span>\n              </span>\n            </p>\n            <span style=\"flex: 1 1 auto\"></span>\n            <button\n              *ngIf=\"(runningTask && (runningTask.workflowID !== workflow.workflowID || runningTaskGroupStatus !== GroupTaskStatus.COMPLETE)) || (!runningTask)\"\n              mat-raised-button\n              color=\"primary\"\n              class=\"sidebar-button\"\n              (click)=\"view(workflow, GroupTaskStatus.COMPLETE)\"\n            >\n              Monitor Task\n            </button>\n            <button\n              *ngIf=\"runningTask && runningTask.workflowID === workflow.workflowID && runningTaskGroupStatus === GroupTaskStatus.COMPLETE\"\n              mat-raised-button\n              color=\"primary\"\n              class=\"sidebar-button\"\n              (click)=\"close()\"\n            >\n              Hide Task\n            </button>\n          </mat-list-item>\n        </ng-container>\n        <mat-divider></mat-divider>\n      </mat-list>\n      <div class=\"feature-buttons\">\n        <button\n          mat-raised-button\n          color=\"primary\"\n          (click)=\"toggleTodos()\"\n        >\n          {{ todoIsVisible? 'Hide TODOs' : 'View by TODOs' }} \n        </button>\n        <button\n          mat-raised-button\n          color=\"primary\"\n          (click)=\"toggleModels()\"\n        >\n          {{ showModels ? 'Hide Learner Models' : 'View Learner Models' }} \n        </button>\n      </div>\n    </mat-sidenav>\n    <mat-sidenav-content>\n      <div *ngIf=\"todoIsVisible\" style=\"margin: 10px\">\n        <mat-form-field appearance=\"fill\" style=\"float: right; margin-bottom: 10px\">\n          <mat-label>Enter a date range</mat-label>\n          <mat-date-range-input [formGroup]=\"todoDeadlineRange\" [rangePicker]=\"picker\">\n            <input\n              matStartDate\n              formControlName=\"start\"\n              (dateChange)=\"filterTodosByDeadline(todoDeadlineRange.value.start, todoDeadlineRange.value.end)\"\n              placeholder=\"Start date\"\n            >\n            <input\n              matEndDate\n              formControlName=\"end\"\n              placeholder=\"End date\"\n              (dateChange)=\"filterTodosByDeadline(todoDeadlineRange.value.start, todoDeadlineRange.value.end)\"\n            >\n          </mat-date-range-input>\n          <mat-datepicker-toggle matSuffix [for]=\"picker\"></mat-datepicker-toggle>\n          <mat-hint>MM/DD/YYYY - MM/DD/YYYY</mat-hint>\n          <mat-date-range-picker #picker>\n            <mat-date-range-picker-actions>\n              <button\n                mat-button\n                matDatepickerCancel\n                (click)=\"clearTodoFilter()\"\n              >\n                Clear\n              </button>\n              <button\n                mat-raised-button\n                color=\"primary\"\n                matDateRangePickerApply\n                (click)=\"filterTodosByDeadline(todoDeadlineRange.value.start, todoDeadlineRange.value.end)\"\n              >\n                Apply\n              </button>\n              <button\n                mat-raised-button\n                color=\"primary\"\n                matDateRangePickerApply\n                (click)=\"setDefaultRange(todoDeadlineRange.value.start, todoDeadlineRange.value.end)\"\n              >\n                Set as Default\n              </button>\n            </mat-date-range-picker-actions>\n          </mat-date-range-picker>\n        \n          <mat-error *ngIf=\"todoDeadlineRange.controls.start.hasError('matStartDateInvalid')\">Invalid start date</mat-error>\n          <mat-error *ngIf=\"todoDeadlineRange.controls.end.hasError('matEndDateInvalid')\">Invalid end date</mat-error>\n        </mat-form-field>\n        <table\n          class=\"table\"\n          mat-table\n          [dataSource]=\"todoDataSource\"\n          matSort\n          matSortActive=\"deadline\"\n          matSortDirection=\"desc\"\n        >\n          <ng-container matColumnDef=\"name\">\n            <th mat-header-cell *matHeaderCellDef mat-sort-header=\"name\"> Student/Group </th>\n            <td mat-cell *matCellDef=\"let element\"> {{element.name}} </td>\n          </ng-container>\n\n          <ng-container matColumnDef=\"goal\">\n            <th mat-header-cell *matHeaderCellDef mat-sort-header=\"goal\"> Goal </th>\n            <td mat-cell *matCellDef=\"let element\"> {{element.goal}} </td>\n          </ng-container>\n\n          <ng-container matColumnDef=\"type\">\n            <th mat-header-cell *matHeaderCellDef> Type </th>\n            <td mat-cell *matCellDef=\"let element\">\n              <mat-chip-list>\n                <mat-chip\n                  *ngFor=\"let type of element.types\"\n                  [ngStyle]=\"{ 'background-color': todoItemColors[type], 'margin': '2px'}\"\n                >\n                  {{ todoItemTypes[type] }}\n                </mat-chip>\n              </mat-chip-list>\n            </td>\n          </ng-container>\n\n          <ng-container matColumnDef=\"status\">\n            <th mat-header-cell *matHeaderCellDef mat-sort-header=\"status\"> Status </th>\n            <td\n              mat-cell\n              *matCellDef=\"let element\"\n              style=\"font-weight: 500\"\n              [ngStyle]=\"{'color': element.overdue? 'red' : (element.completed? 'green' : 'orange')}\"\n            >\n              {{element.status}}\n            </td>\n          </ng-container>\n\n          <ng-container matColumnDef=\"deadline\">\n            <th mat-header-cell *matHeaderCellDef mat-sort-header=\"deadline\"> Deadline </th>\n            <td mat-cell *matCellDef=\"let element\"> {{element.deadline}} </td>\n          </ng-container>\n\n          <ng-container matColumnDef=\"completion-quality\">\n            <th mat-header-cell *matHeaderCellDef> Completion Quality </th>\n            <td mat-cell *matCellDef=\"let element\"> {{element.quality}} </td>\n          </ng-container>\n\n          <ng-container matColumnDef=\"completion-notes\">\n            <th mat-header-cell *matHeaderCellDef> Completion Notes </th>\n            <td mat-cell *matCellDef=\"let element\"> TBD </td>\n          </ng-container>\n\n          <tr mat-header-row *matHeaderRowDef=\"todoColumns\"></tr>\n          <tr mat-row *matRowDef=\"let row; columns: todoColumns;\" class=\"todoItemRow\" (click)=\"openTodoItemViewModal(row)\"></tr>\n        </table>\n      </div>\n      <div *ngIf=\"showModels\">\n        <app-learner-models #learner [board]=\"board\" [project]=\"project\" [studentView]=\"studentView\"></app-learner-models>\n      </div>\n      <mat-progress-bar style=\"margin: 20px; width: 95%\" mode=\"indeterminate\" *ngIf=\"loading\"></mat-progress-bar>\n      <div class=\"heading no-workflow-select\" *ngIf=\"!runningTask && !todoIsVisible && !showModels && !studentView\">\n        No task selected!\n        <mat-progress-bar class=\"mat-loading-progress-bar\" mode=\"indeterminate\" *ngIf=\"loading\"></mat-progress-bar>\n      </div>\n      <div style=\"display: flex; flex-direction: row;\">\n        <div *ngIf=\"runningTask && !todoIsVisible\">\n          <mat-card style=\"margin: 7px; padding: 16px 4px;\">\n            <mat-card-title>Task Progress</mat-card-title>\n            <div class=\"mat-elevation-z3 table_style\">\n              <table mat-table [dataSource]=\"runningTaskTableData\" class=\"table\">\n\n                <ng-container matColumnDef=\"group-name\">\n                  <th mat-header-cell *matHeaderCellDef> Group Name </th>\n                  <td mat-cell *matCellDef=\"let group\"> {{group.groupName}} </td>\n                </ng-container>\n\n                <ng-container matColumnDef=\"members\">\n                  <th mat-header-cell *matHeaderCellDef> Members </th>\n                  <td mat-cell *matCellDef=\"let group\"> {{group.groupMembers.join(', ')}}</td>\n                </ng-container>\n\n                <ng-container matColumnDef=\"progress\">\n                  <th mat-header-cell *matHeaderCellDef> Progress </th>\n                  <td mat-cell *matCellDef=\"let group\"> {{group.progress}} % </td>\n                </ng-container>\n\n                <ng-container matColumnDef=\"action\">\n                  <th mat-header-cell *matHeaderCellDef > {{ runningTaskGroupStatus === GroupTaskStatus.INACTIVE ? \"\" : \"Action\"}} </th>\n                  <td mat-cell *matCellDef=\"let group\"> \n                    <button \n                      *ngIf=\"runningTaskGroupStatus !== GroupTaskStatus.INACTIVE\" mat-icon-button \n                      (click)=\"\n                        runningTaskGroupStatus === GroupTaskStatus.COMPLETE \n                        ? activateGroupTask(group) \n                        : completeGroupTask(group)\"\n                      \n                    >\n                      <mat-icon matTooltip=\"Re-activate Task\" *ngIf=\"runningTaskGroupStatus === GroupTaskStatus.COMPLETE\">\n                        play_circle_outline\n                      </mat-icon>\n                      <mat-icon matTooltip=\"Cancel Task\" *ngIf=\"runningTaskGroupStatus === GroupTaskStatus.ACTIVE\">\n                        cancel\n                      </mat-icon>\n                    </button>  \n                  </td>\n                </ng-container>\n\n            \n                <tr mat-header-row *matHeaderRowDef=\"displayColumns\"></tr>\n                <tr mat-row *matRowDef=\"let row; columns: displayColumns;\"></tr>\n              </table>\n            </div>\n          </mat-card>\n        </div>\n        <div *ngIf=\"runningTask && !todoIsVisible\">\n          <mat-card class=\"example-card\" style=\"width: 350px; margin: 10px auto\">\n            <mat-card-title>{{runningTask.name}}</mat-card-title>\n            <mat-card-content>\n              <p>{{ runningTask.prompt }} </p>\n              <section>\n                <h5>Actions Required:</h5>\n                <ul style=\"list-style-position: inside; padding-left: 0; font-weight: bold;\">\n                  <li *ngIf=\"hasCommentRequirement(runningTask)\">Comment on each post at least once!</li>\n                  <li *ngIf=\"hasTagRequirement(runningTask)\">Tag each post at least once!</li>\n                </ul>\n              </section>\n            </mat-card-content>\n            <div style=\"margin-bottom: 10px;\">\n              <label class=\"example-margin\">Max Progress</label>\n              <mat-progress-bar mode=\"determinate\" [value]=\"maxGroupProgress\"></mat-progress-bar>\n            </div>\n            <div style=\"margin-bottom: 10px;\">\n              <label class=\"example-margin\">Avg Progress</label>\n              <mat-progress-bar mode=\"determinate\" [value]=\"averageGroupProgress\" color=\"accent\"></mat-progress-bar>\n            </div>\n            <div style=\"margin-bottom: 10px;\">\n              <label class=\"example-margin\">Min Progress</label>\n              <mat-progress-bar mode=\"determinate\" [value]=\"minGroupProgress\" color=\"accent\"></mat-progress-bar>\n            </div>\n          </mat-card>\n        </div>\n      </div>\n    </mat-sidenav-content>\n  </mat-sidenav-container>\n</div>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}