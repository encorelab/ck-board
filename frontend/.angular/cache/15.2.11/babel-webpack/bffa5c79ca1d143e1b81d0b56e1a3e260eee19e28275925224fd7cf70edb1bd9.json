{"ast":null,"code":"import _asyncToGenerator from \"/Users/marieklinaeva/github/ck-board/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { transferArrayItem } from '@angular/cdk/drag-drop';\nimport { MatLegacyPaginator as MatPaginator } from '@angular/material/legacy-paginator';\nimport { BoardScope, ViewType } from 'src/app/models/board';\nimport { Role } from 'src/app/models/user';\nimport Converters from 'src/app/utils/converters';\nimport { CreateWorkflowModalComponent } from '../create-workflow-modal/create-workflow-modal.component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/post.service\";\nimport * as i2 from \"src/app/services/board.service\";\nimport * as i3 from \"src/app/services/project.service\";\nimport * as i4 from \"src/app/services/bucket.service\";\nimport * as i5 from \"src/app/services/user.service\";\nimport * as i6 from \"@angular/material/legacy-dialog\";\nimport * as i7 from \"src/app/services/comment.service\";\nimport * as i8 from \"src/app/services/upvotes.service\";\nimport * as i9 from \"@angular/router\";\nimport * as i10 from \"@angular/common\";\nimport * as i11 from \"@angular/material/legacy-button\";\nimport * as i12 from \"@angular/material/icon\";\nimport * as i13 from \"@angular/material/legacy-tooltip\";\nimport * as i14 from \"@angular/material/legacy-menu\";\nimport * as i15 from \"@angular/material/legacy-progress-spinner\";\nimport * as i16 from \"@angular/cdk/drag-drop\";\nimport * as i17 from \"../html-post/html-post.component\";\nimport * as i18 from \"../toolbar/toolbar.component\";\nimport * as i19 from \"../toolbar-menu/toolbar-menu.component\";\nimport * as i20 from \"../view-navigation/view-navigation.component\";\nfunction CkBucketsComponent_app_toolbar_0_span_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 18);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r7 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r7.board.name);\n  }\n}\nfunction CkBucketsComponent_app_toolbar_0_button_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 19);\n    i0.ɵɵlistener(\"click\", function CkBucketsComponent_app_toolbar_0_button_2_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r9 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r9.board.scope === ctx_r9.BoardScope.PROJECT_SHARED ? ctx_r9.copyEmbedCode() : ctx_r9.copyPersonalEmbedCode());\n    });\n    i0.ɵɵelementStart(1, \"mat-icon\");\n    i0.ɵɵtext(2, \"file_copy\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction CkBucketsComponent_app_toolbar_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"app-toolbar\", 13);\n    i0.ɵɵtemplate(1, CkBucketsComponent_app_toolbar_0_span_1_Template, 2, 1, \"span\", 14);\n    i0.ɵɵtemplate(2, CkBucketsComponent_app_toolbar_0_button_2_Template, 3, 0, \"button\", 15);\n    i0.ɵɵelement(3, \"span\", 5)(4, \"app-view-navigation\", 16)(5, \"app-toolbar-menu\", 17);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"user\", ctx_r0.user);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.board && ctx_r0.board.name);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.user.role === ctx_r0.Role.TEACHER);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"boardID\", ctx_r0.boardID)(\"currentView\", ctx_r0.viewType);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"board\", ctx_r0.board)(\"project\", ctx_r0.project);\n  }\n}\nfunction CkBucketsComponent_div_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\")(1, \"button\", 20)(2, \"mat-icon\", 21);\n    i0.ɵɵtext(3, \"add\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    const _r4 = i0.ɵɵreference(15);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"matMenuTriggerFor\", _r4)(\"hidden\", ctx_r1.bucketsOnView.length >= ctx_r1.maxBucketsOnView);\n  }\n}\nfunction CkBucketsComponent_h3_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"h3\", 22);\n    i0.ɵɵtext(1, \" No buckets available \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CkBucketsComponent_div_13_button_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r19 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 29);\n    i0.ɵɵlistener(\"click\", function CkBucketsComponent_div_13_button_4_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r19);\n      const ctx_r18 = i0.ɵɵnextContext();\n      const bucket_r11 = ctx_r18.$implicit;\n      const idx_r12 = ctx_r18.index;\n      const ctx_r17 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r17.removeBucketFromView(bucket_r11, idx_r12));\n    });\n    i0.ɵɵelementStart(1, \"mat-icon\");\n    i0.ɵɵtext(2, \"close\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction CkBucketsComponent_div_13_mat_spinner_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"mat-spinner\", 30);\n  }\n}\nfunction CkBucketsComponent_div_13_h3_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"h3\", 31);\n    i0.ɵɵtext(1, \"No posts in bucket!\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CkBucketsComponent_div_13_div_7_ng_container_1_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵelement(1, \"app-html-post\", 34);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const post_r22 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"post\", post_r22);\n  }\n}\nfunction CkBucketsComponent_div_13_div_7_ng_container_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, CkBucketsComponent_div_13_div_7_ng_container_1_div_1_Template, 2, 1, \"div\", 33);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const bucket_r11 = i0.ɵɵnextContext(2).$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", bucket_r11.htmlPosts);\n  }\n}\nfunction CkBucketsComponent_div_13_div_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 32);\n    i0.ɵɵtemplate(1, CkBucketsComponent_div_13_div_7_ng_container_1_Template, 2, 1, \"ng-container\", 6);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const bucket_r11 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", bucket_r11.htmlPosts && bucket_r11.htmlPosts.length > 0);\n  }\n}\nfunction CkBucketsComponent_div_13_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r26 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 23);\n    i0.ɵɵlistener(\"cdkDropListDropped\", function CkBucketsComponent_div_13_Template_div_cdkDropListDropped_0_listener($event) {\n      i0.ɵɵrestoreView(_r26);\n      const ctx_r25 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r25.dragDropPostInBucket($event));\n    });\n    i0.ɵɵelementStart(1, \"div\", 24)(2, \"h3\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(4, CkBucketsComponent_div_13_button_4_Template, 3, 0, \"button\", 25);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(5, CkBucketsComponent_div_13_mat_spinner_5_Template, 1, 0, \"mat-spinner\", 26);\n    i0.ɵɵtemplate(6, CkBucketsComponent_div_13_h3_6_Template, 2, 0, \"h3\", 27);\n    i0.ɵɵtemplate(7, CkBucketsComponent_div_13_div_7_Template, 2, 1, \"div\", 28);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const bucket_r11 = ctx.$implicit;\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"cdkDropListData\", bucket_r11.htmlPosts);\n    i0.ɵɵattribute(\"data-bucket\", bucket_r11.bucketID);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(bucket_r11.name);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.user.role === ctx_r3.Role.TEACHER);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", bucket_r11.loading);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", bucket_r11.htmlPosts && bucket_r11.htmlPosts.length == 0);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !bucket_r11.loading);\n  }\n}\nfunction CkBucketsComponent_button_16_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r30 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 35);\n    i0.ɵɵlistener(\"click\", function CkBucketsComponent_button_16_Template_button_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r30);\n      const bucket_r27 = restoredCtx.$implicit;\n      const idx_r28 = restoredCtx.index;\n      const ctx_r29 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r29.addBucketToView(bucket_r27, idx_r28));\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const bucket_r27 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", bucket_r27);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", bucket_r27.name, \" \");\n  }\n}\nfunction CkBucketsComponent_button_17_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r32 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 36);\n    i0.ɵɵlistener(\"click\", function CkBucketsComponent_button_17_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r32);\n      const ctx_r31 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r31.openWorkflowDialog());\n    });\n    i0.ɵɵtext(1, \" Create New Bucket \");\n    i0.ɵɵelementEnd();\n  }\n}\nexport class CkBucketsComponent {\n  postService;\n  boardService;\n  projectService;\n  bucketService;\n  userService;\n  dialog;\n  commentService;\n  upvotesService;\n  converters;\n  router;\n  activatedRoute;\n  paginator;\n  boardID;\n  projectID;\n  buckets = [];\n  // posts: any[] = [];\n  user;\n  board;\n  project;\n  Role = Role;\n  ViewType = ViewType;\n  BoardScope = BoardScope;\n  maxBucketsOnView = 4;\n  bucketsOnView = [];\n  viewType = ViewType.BUCKETS;\n  constructor(postService, boardService, projectService, bucketService, userService, dialog, commentService, upvotesService, converters, router, activatedRoute) {\n    this.postService = postService;\n    this.boardService = boardService;\n    this.projectService = projectService;\n    this.bucketService = bucketService;\n    this.userService = userService;\n    this.dialog = dialog;\n    this.commentService = commentService;\n    this.upvotesService = upvotesService;\n    this.converters = converters;\n    this.router = router;\n    this.activatedRoute = activatedRoute;\n  }\n  ngOnInit() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      _this.user = _this.userService.user;\n      yield _this.configureBoard();\n      yield _this.bucketService.getAllByBoard(_this.boardID).then(buckets => {\n        for (const bucket of buckets) {\n          if (bucket.addedToView) {\n            _this.bucketsOnView.push(bucket);\n            _this.loadBucketPosts(bucket);\n          } else {\n            _this.buckets.push(bucket);\n          }\n        }\n      });\n    })();\n  }\n  configureBoard() {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      const map = _this2.activatedRoute.snapshot.paramMap;\n      if (map.has('boardID') && map.has('projectID')) {\n        _this2.boardID = _this2.activatedRoute.snapshot.paramMap.get('boardID') ?? '';\n        _this2.projectID = _this2.activatedRoute.snapshot.paramMap.get('projectID') ?? '';\n        _this2.boardService.get(_this2.boardID).then(board => {\n          if (board) _this2.board = board;\n          if (board.viewSettings && !board.viewSettings.allowBuckets) {\n            _this2.router.navigateByUrl(`project/${_this2.projectID}/board/${_this2.boardID}/${board.defaultView?.toLowerCase()}`);\n          }\n        });\n        // this.postService.getAllByBoard(this.boardID).then(data => {\n        //   this.posts = data;\n        // });\n        _this2.projectService.get(_this2.projectID).then(project => {\n          _this2.project = project;\n        });\n      }\n    })();\n  }\n  loadBucketPosts(bucket) {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      if (!bucket.htmlPosts) {\n        bucket.loading = true;\n        bucket.htmlPosts = yield _this3.converters.toHTMLPosts(bucket.posts);\n        bucket.loading = false;\n      }\n    })();\n  }\n  copyEmbedCode() {\n    const url = window.location.href + '?embedded=true';\n    navigator.clipboard.writeText(url);\n  }\n  copyPersonalEmbedCode() {\n    const url = window.location.origin + `/project/${this.projectID}/my-personal-board?embedded=true`;\n    navigator.clipboard.writeText(url);\n  }\n  addBucketToView(bucket, index) {\n    if (bucket && index >= 0 && index < this.buckets.length) {\n      this.buckets.splice(index, 1);\n      this.bucketsOnView.push(bucket);\n      this.loadBucketPosts(bucket);\n      this.bucketService.update(bucket.bucketID, {\n        addedToView: true\n      });\n    }\n  }\n  removeBucketFromView(bucket, index) {\n    if (bucket) {\n      this.buckets.push(bucket);\n      this.bucketsOnView.splice(index, 1);\n      this.bucketService.update(bucket.bucketID, {\n        addedToView: false\n      });\n    }\n  }\n  dragDropPostInBucket(event) {\n    if (event.previousContainer !== event.container) {\n      const post = event.previousContainer.data[event.previousIndex].post;\n      if (!post) return;\n      if (event.container.data.filter(p => p.post.postID === post.postID).length === 0) {\n        transferArrayItem(event.previousContainer.data, event.container.data, event.previousIndex, event.currentIndex);\n      } else {\n        event.previousContainer.data.splice(event.previousIndex);\n      }\n      // transfer the html post\n      // persist post transfer with db\n      const sourceBucketId = event.previousContainer.element.nativeElement.dataset.bucket;\n      const targetBucketId = event.container.element.nativeElement.dataset.bucket;\n      if (sourceBucketId) {\n        this.bucketService.remove(sourceBucketId, post.postID);\n      }\n      if (targetBucketId) {\n        this.bucketService.add(targetBucketId, post.postID);\n      }\n    }\n  }\n  openWorkflowDialog() {\n    this._openDialog(CreateWorkflowModalComponent, {\n      board: this.board,\n      project: this.project,\n      onBucketCreation: bucket => {\n        this.bucketsOnView.push(bucket);\n        this.loadBucketPosts(bucket);\n        this.bucketService.update(bucket.bucketID, {\n          addedToView: true\n        });\n      }\n    });\n  }\n  signOut() {\n    this.userService.logout();\n    this.router.navigate(['login']);\n  }\n  _openDialog(component, data, width = '700px') {\n    this.dialog.open(component, {\n      maxWidth: 1280,\n      width: width,\n      autoFocus: false,\n      data: data\n    });\n  }\n  static ɵfac = function CkBucketsComponent_Factory(t) {\n    return new (t || CkBucketsComponent)(i0.ɵɵdirectiveInject(i1.PostService), i0.ɵɵdirectiveInject(i2.BoardService), i0.ɵɵdirectiveInject(i3.ProjectService), i0.ɵɵdirectiveInject(i4.BucketService), i0.ɵɵdirectiveInject(i5.UserService), i0.ɵɵdirectiveInject(i6.MatLegacyDialog), i0.ɵɵdirectiveInject(i7.CommentService), i0.ɵɵdirectiveInject(i8.UpvotesService), i0.ɵɵdirectiveInject(Converters), i0.ɵɵdirectiveInject(i9.Router), i0.ɵɵdirectiveInject(i9.ActivatedRoute));\n  };\n  static ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: CkBucketsComponent,\n    selectors: [[\"app-ck-buckets\"]],\n    viewQuery: function CkBucketsComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(MatPaginator, 5);\n      }\n      if (rf & 2) {\n        let _t;\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.paginator = _t.first);\n      }\n    },\n    decls: 18,\n    vars: 7,\n    consts: [[3, \"user\", 4, \"ngIf\"], [1, \"container\", \"d-flex\", \"align-items-center\", \"justify-content-center\"], [1, \"heading\"], [\"mat-icon-button\", \"\", \"aria-label\", \"Return to Dashboard\", 3, \"routerLink\"], [\"mat-title\", \"\", 2, \"margin\", \"0\"], [2, \"flex\", \"1 1 auto\"], [4, \"ngIf\"], [\"cdkDropListGroup\", \"\", 1, \"buckets\"], [\"style\", \"color: grey; text-align: center\", 4, \"ngIf\"], [\"class\", \"bucket\", \"cdkDropList\", \"\", \"cdkDropListSortingDisabled\", \"\", 3, \"cdkDropListData\", \"cdkDropListDropped\", 4, \"ngFor\", \"ngForOf\"], [\"bucketsMenu\", \"matMenu\"], [\"mat-menu-item\", \"\", 3, \"value\", \"click\", 4, \"ngFor\", \"ngForOf\"], [\"mat-menu-item\", \"\", 3, \"click\", 4, \"ngIf\"], [3, \"user\"], [\"class\", \"toolbarTitle\", 4, \"ngIf\"], [\"mat-icon-button\", \"\", \"matTooltip\", \"Copy embeddable URL\", 3, \"click\", 4, \"ngIf\"], [3, \"boardID\", \"currentView\"], [\"navbarMenu\", \"\", 3, \"board\", \"project\"], [1, \"toolbarTitle\"], [\"mat-icon-button\", \"\", \"matTooltip\", \"Copy embeddable URL\", 3, \"click\"], [\"mat-icon-button\", \"\", \"matTooltip\", \"Add bucket to view\", 3, \"matMenuTriggerFor\", \"hidden\"], [1, \"material-icons-outlined\"], [2, \"color\", \"grey\", \"text-align\", \"center\"], [\"cdkDropList\", \"\", \"cdkDropListSortingDisabled\", \"\", 1, \"bucket\", 3, \"cdkDropListData\", \"cdkDropListDropped\"], [1, \"header\"], [\"mat-icon-button\", \"\", 3, \"click\", 4, \"ngIf\"], [\"class\", \"spinner\", 4, \"ngIf\"], [\"style\", \"color: grey; margin-top: 10px;text-align: center;\", 4, \"ngIf\"], [\"class\", \"post-list-view\", 4, \"ngIf\"], [\"mat-icon-button\", \"\", 3, \"click\"], [1, \"spinner\"], [2, \"color\", \"grey\", \"margin-top\", \"10px\", \"text-align\", \"center\"], [1, \"post-list-view\"], [4, \"ngFor\", \"ngForOf\"], [\"cdkDrag\", \"\", 2, \"width\", \"100%\", 3, \"post\"], [\"mat-menu-item\", \"\", 3, \"value\", \"click\"], [\"mat-menu-item\", \"\", 3, \"click\"]],\n    template: function CkBucketsComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵtemplate(0, CkBucketsComponent_app_toolbar_0_Template, 6, 7, \"app-toolbar\", 0);\n        i0.ɵɵelementStart(1, \"div\", 1)(2, \"div\", 2)(3, \"button\", 3)(4, \"mat-icon\");\n        i0.ɵɵtext(5, \"arrow_back\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(6, \"h1\", 4)(7, \"span\");\n        i0.ɵɵtext(8, \"CK Buckets\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelement(9, \"span\", 5);\n        i0.ɵɵtemplate(10, CkBucketsComponent_div_10_Template, 4, 2, \"div\", 6);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(11, \"div\", 7);\n        i0.ɵɵtemplate(12, CkBucketsComponent_h3_12_Template, 2, 0, \"h3\", 8);\n        i0.ɵɵtemplate(13, CkBucketsComponent_div_13_Template, 8, 7, \"div\", 9);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(14, \"mat-menu\", null, 10);\n        i0.ɵɵtemplate(16, CkBucketsComponent_button_16_Template, 2, 2, \"button\", 11);\n        i0.ɵɵtemplate(17, CkBucketsComponent_button_17_Template, 2, 0, \"button\", 12);\n        i0.ɵɵelementEnd();\n      }\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngIf\", ctx.user);\n        i0.ɵɵadvance(3);\n        i0.ɵɵpropertyInterpolate(\"routerLink\", \"/project/\" + ctx.project.projectID);\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"ngIf\", ctx.user.role === ctx.Role.TEACHER && ctx.bucketsOnView.length >= 0 && ctx.bucketsOnView.length < ctx.maxBucketsOnView);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.buckets.length === 0 && ctx.bucketsOnView.length === 0);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngForOf\", ctx.bucketsOnView);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngForOf\", ctx.buckets);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.user.role === ctx.Role.TEACHER && !!ctx.board && ctx.board.scope === ctx.BoardScope.PROJECT_SHARED);\n      }\n    },\n    dependencies: [i10.NgForOf, i10.NgIf, i9.RouterLink, i11.MatLegacyButton, i12.MatIcon, i13.MatLegacyTooltip, i14.MatLegacyMenu, i14.MatLegacyMenuItem, i14.MatLegacyMenuTrigger, i15.MatLegacyProgressSpinner, i16.CdkDropList, i16.CdkDropListGroup, i16.CdkDrag, i17.HtmlPostComponent, i18.ToolbarComponent, i19.ToolbarMenuComponent, i20.ViewNavigationComponent],\n    styles: [\".post-list[_ngcontent-%COMP%] {\\n  display: grid;\\n  grid-gap: 1em;\\n  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));\\n  padding-bottom: 10px;\\n}\\n\\n.container[_ngcontent-%COMP%] {\\n  height: 100vh;\\n  padding: 15px;\\n}\\n.container[_ngcontent-%COMP%]   .heading[_ngcontent-%COMP%] {\\n  display: flex;\\n  align-items: center;\\n  margin-bottom: 10px;\\n}\\n.container[_ngcontent-%COMP%]   .mat-dialog-title[_ngcontent-%COMP%] {\\n  display: flex;\\n  align-items: center;\\n  justify-content: space-between;\\n}\\n.container[_ngcontent-%COMP%]   .mat-dialog-content[_ngcontent-%COMP%] {\\n  max-height: 75vh;\\n}\\n.container[_ngcontent-%COMP%]   .mat-paginator[_ngcontent-%COMP%] {\\n  display: flex;\\n  justify-content: center;\\n}\\n.container[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%] {\\n  margin: 70px auto;\\n  background: transparent;\\n}\\n.container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%] {\\n  display: flex;\\n  flex-direction: row;\\n}\\n.container[_ngcontent-%COMP%]   .buckets[_ngcontent-%COMP%] {\\n  min-height: 60vh;\\n  border: 1px rgb(196, 193, 193);\\n  border-style: solid;\\n  border-radius: 4px;\\n  display: flex;\\n  overflow: auto;\\n}\\n.container[_ngcontent-%COMP%]   .buckets[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   .buckets[_ngcontent-%COMP%]   div[_ngcontent-%COMP%] {\\n  justify-content: center;\\n  align-items: center;\\n}\\n.container[_ngcontent-%COMP%]   .buckets[_ngcontent-%COMP%]   .bucket[_ngcontent-%COMP%] {\\n  display: block;\\n  flex: 1;\\n  padding: 0 10px 10px 10px;\\n  border: 1px solid rgb(220, 219, 219);\\n  min-width: 300px;\\n}\\n.container[_ngcontent-%COMP%]   .buckets[_ngcontent-%COMP%]   .bucket[_ngcontent-%COMP%]   .post-list-view[_ngcontent-%COMP%] {\\n  display: grid;\\n  grid-gap: 1em;\\n  grid-template-columns: repeat(auto-fill, 280px);\\n  grid-auto-rows: minmax(100px, auto);\\n  grid-auto-flow: dense;\\n  padding: 10px 0;\\n}\\n.container[_ngcontent-%COMP%]   .buckets[_ngcontent-%COMP%]   .bucket[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%] {\\n  top: 0;\\n  border-bottom: 1px solid rgb(220, 219, 219);\\n  display: flex;\\n  align-items: center;\\n  justify-content: space-between;\\n  text-align: center;\\n  padding: 5px 0;\\n}\\n.container[_ngcontent-%COMP%]   .buckets[_ngcontent-%COMP%]   .bucket[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%] {\\n  margin: 0;\\n  flex: 1;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9zdHlsZS9sYXlvdXQvX3Bvc3QtbGlzdC5zY3NzIiwid2VicGFjazovLy4vc3JjL2FwcC9jb21wb25lbnRzL2NrLWJ1Y2tldHMvY2stYnVja2V0cy5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLGFBQUE7RUFDQSxhQUFBO0VBQ0EsNERBQUE7RUFDQSxvQkFBQTtBQ0NGOztBQUhBO0VBQ0ksYUFBQTtFQUNBLGFBQUE7QUFNSjtBQUpJO0VBQ0UsYUFBQTtFQUNBLG1CQUFBO0VBQ0EsbUJBQUE7QUFNTjtBQUhJO0VBQ0ksYUFBQTtFQUNBLG1CQUFBO0VBQ0EsOEJBQUE7QUFLUjtBQUZJO0VBQ0ksZ0JBQUE7QUFJUjtBQURJO0VBQ0ksYUFBQTtFQUNBLHVCQUFBO0FBR1I7QUFBSTtFQUNJLGlCQUFBO0VBQ0EsdUJBQUE7QUFFUjtBQUNJO0VBQ0ksYUFBQTtFQUNBLG1CQUFBO0FBQ1I7QUFFSTtFQUNJLGdCQUFBO0VBQ0EsOEJBQUE7RUFDQSxtQkFBQTtFQUNBLGtCQUFBO0VBQ0EsYUFBQTtFQUNBLGNBQUE7QUFBUjtBQUVRO0VBQ0UsdUJBQUE7RUFDQSxtQkFBQTtBQUFWO0FBR1E7RUFDSSxjQUFBO0VBQ0EsT0FBQTtFQUNBLHlCQUFBO0VBQ0Esb0NBQUE7RUFDQSxnQkFBQTtBQURaO0FBR1k7RUFDRSxhQUFBO0VBQ0EsYUFBQTtFQUNBLCtDQUFBO0VBQ0EsbUNBQUE7RUFDQSxxQkFBQTtFQUNBLGVBQUE7QUFEZDtBQUlZO0VBQ0ksTUFBQTtFQUNBLDJDQUFBO0VBQ0EsYUFBQTtFQUNBLG1CQUFBO0VBQ0EsOEJBQUE7RUFDQSxrQkFBQTtFQUNBLGNBQUE7QUFGaEI7QUFJZ0I7RUFDRSxTQUFBO0VBQ0EsT0FBQTtBQUZsQiIsInNvdXJjZXNDb250ZW50IjpbIi5wb3N0LWxpc3Qge1xuICBkaXNwbGF5OiBncmlkO1xuICBncmlkLWdhcDogMWVtO1xuICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IHJlcGVhdChhdXRvLWZpbGwsIG1pbm1heCgyODBweCwgMWZyKSk7XG4gIHBhZGRpbmctYm90dG9tOiAxMHB4O1xufVxuIiwiQHVzZSAnLi4vLi4vLi4vc3R5bGUvbGF5b3V0L3Bvc3QtbGlzdCc7XG5cbi5jb250YWluZXIge1xuICAgIGhlaWdodDogMTAwdmg7XG4gICAgcGFkZGluZzogMTVweDtcblxuICAgIC5oZWFkaW5ne1xuICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgICBtYXJnaW4tYm90dG9tOiAxMHB4O1xuICAgIH1cblxuICAgIC5tYXQtZGlhbG9nLXRpdGxlIHtcbiAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuO1xuICAgIH1cblxuICAgIC5tYXQtZGlhbG9nLWNvbnRlbnQge1xuICAgICAgICBtYXgtaGVpZ2h0OiA3NXZoO1xuICAgIH1cblxuICAgIC5tYXQtcGFnaW5hdG9yIHtcbiAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG4gICAgfVxuXG4gICAgLnNwaW5uZXIge1xuICAgICAgICBtYXJnaW46IDcwcHggYXV0bztcbiAgICAgICAgYmFja2dyb3VuZDogdHJhbnNwYXJlbnQ7XG4gICAgfVxuXG4gICAgLmhlYWRlciB7XG4gICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgIGZsZXgtZGlyZWN0aW9uOiByb3c7XG4gICAgfVxuXG4gICAgLmJ1Y2tldHMge1xuICAgICAgICBtaW4taGVpZ2h0OiA2MHZoO1xuICAgICAgICBib3JkZXI6IDFweCByZ2IoMTk2LCAxOTMsIDE5Myk7XG4gICAgICAgIGJvcmRlci1zdHlsZTogc29saWQ7XG4gICAgICAgIGJvcmRlci1yYWRpdXM6IDRweDtcbiAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgb3ZlcmZsb3c6IGF1dG87XG5cbiAgICAgICAgaDMsIGRpdiB7XG4gICAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG4gICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAgfVxuXG4gICAgICAgIC5idWNrZXQge1xuICAgICAgICAgICAgZGlzcGxheTogYmxvY2s7XG4gICAgICAgICAgICBmbGV4OiAxO1xuICAgICAgICAgICAgcGFkZGluZzogMCAxMHB4IDEwcHggMTBweDtcbiAgICAgICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHJnYigyMjAsIDIxOSwgMjE5KTtcbiAgICAgICAgICAgIG1pbi13aWR0aDogMzAwcHg7XG5cbiAgICAgICAgICAgIC5wb3N0LWxpc3Qtdmlld3tcbiAgICAgICAgICAgICAgZGlzcGxheTogZ3JpZDtcbiAgICAgICAgICAgICAgZ3JpZC1nYXA6IDFlbTtcbiAgICAgICAgICAgICAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiByZXBlYXQoYXV0by1maWxsLCAyODBweCk7XG4gICAgICAgICAgICAgIGdyaWQtYXV0by1yb3dzOiBtaW5tYXgoMTAwcHgsIGF1dG8pO1xuICAgICAgICAgICAgICBncmlkLWF1dG8tZmxvdzogZGVuc2U7XG4gICAgICAgICAgICAgIHBhZGRpbmc6IDEwcHggMDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLmhlYWRlciB7XG4gICAgICAgICAgICAgICAgdG9wOiAwO1xuICAgICAgICAgICAgICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCByZ2IoMjIwLCAyMTksIDIxOSk7XG4gICAgICAgICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgICAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjtcbiAgICAgICAgICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4gICAgICAgICAgICAgICAgcGFkZGluZzogNXB4IDA7XG5cbiAgICAgICAgICAgICAgICBoMyB7XG4gICAgICAgICAgICAgICAgICBtYXJnaW46IDA7XG4gICAgICAgICAgICAgICAgICBmbGV4OiAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn0iXSwic291cmNlUm9vdCI6IiJ9 */\"]\n  });\n}","map":{"version":3,"mappings":"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","names":["transferArrayItem","MatLegacyPaginator","MatPaginator","BoardScope","ViewType","Role","Converters","CreateWorkflowModalComponent","i0","ctx_r9","CkBucketsComponent","postService","boardService","projectService","bucketService","userService","dialog","commentService","upvotesService","converters","router","activatedRoute","paginator","boardID","projectID","buckets","user","board","project","maxBucketsOnView","bucketsOnView","viewType","BUCKETS","constructor","ngOnInit","configureBoard","getAllByBoard","then","bucket","addedToView","push","loadBucketPosts","map","snapshot","paramMap","has","get","viewSettings","allowBuckets","navigateByUrl","defaultView","toLowerCase","htmlPosts","loading","toHTMLPosts","posts","copyEmbedCode","url","window","location","href","navigator","clipboard","writeText","copyPersonalEmbedCode","origin","addBucketToView","index","length","splice","update","bucketID","removeBucketFromView","dragDropPostInBucket","event","previousContainer","container","post","data","previousIndex","filter","p","postID","currentIndex","sourceBucketId","element","nativeElement","dataset","targetBucketId","remove","add","openWorkflowDialog","_openDialog","onBucketCreation","signOut","logout","navigate","component","width","open","maxWidth","autoFocus","selectors","viewQuery"],"sourceRoot":"","sources":["/Users/marieklinaeva/github/ck-board/frontend/src/app/components/ck-buckets/ck-buckets.component.ts","/Users/marieklinaeva/github/ck-board/frontend/src/app/components/ck-buckets/ck-buckets.component.html"],"sourcesContent":["import { CdkDragDrop, transferArrayItem } from '@angular/cdk/drag-drop';\nimport { ComponentType } from '@angular/cdk/portal';\nimport { Component, OnInit, ViewChild } from '@angular/core';\nimport { MatLegacyDialog as MatDialog } from '@angular/material/legacy-dialog';\nimport { MatLegacyPaginator as MatPaginator } from '@angular/material/legacy-paginator';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { Board, BoardScope, ViewType } from 'src/app/models/board';\nimport { Project } from 'src/app/models/project';\nimport { AuthUser, Role } from 'src/app/models/user';\nimport { BoardService } from 'src/app/services/board.service';\nimport { BucketService } from 'src/app/services/bucket.service';\nimport { CommentService } from 'src/app/services/comment.service';\nimport { PostService } from 'src/app/services/post.service';\nimport { ProjectService } from 'src/app/services/project.service';\nimport { UpvotesService } from 'src/app/services/upvotes.service';\nimport { UserService } from 'src/app/services/user.service';\nimport Converters from 'src/app/utils/converters';\nimport { CreateWorkflowModalComponent } from '../create-workflow-modal/create-workflow-modal.component';\n\n@Component({\n  selector: 'app-ck-buckets',\n  templateUrl: './ck-buckets.component.html',\n  styleUrls: ['./ck-buckets.component.scss'],\n})\nexport class CkBucketsComponent implements OnInit {\n  @ViewChild(MatPaginator) paginator: MatPaginator;\n\n  boardID: string;\n  projectID: string;\n\n  buckets: any[] = [];\n  // posts: any[] = [];\n\n  user: AuthUser;\n  board: Board;\n  project: Project;\n  Role: typeof Role = Role;\n  ViewType: typeof ViewType = ViewType;\n  BoardScope: typeof BoardScope = BoardScope;\n\n  maxBucketsOnView = 4;\n  bucketsOnView: any[] = [];\n\n  viewType = ViewType.BUCKETS;\n\n  constructor(\n    public postService: PostService,\n    public boardService: BoardService,\n    public projectService: ProjectService,\n    public bucketService: BucketService,\n    public userService: UserService,\n    public dialog: MatDialog,\n    public commentService: CommentService,\n    public upvotesService: UpvotesService,\n    private converters: Converters,\n    private router: Router,\n    private activatedRoute: ActivatedRoute\n  ) {}\n\n  async ngOnInit(): Promise<void> {\n    this.user = this.userService.user!;\n    await this.configureBoard();\n    await this.bucketService.getAllByBoard(this.boardID).then((buckets) => {\n      for (const bucket of buckets) {\n        if (bucket.addedToView) {\n          this.bucketsOnView.push(bucket);\n          this.loadBucketPosts(bucket);\n        } else {\n          this.buckets.push(bucket);\n        }\n      }\n    });\n  }\n\n  async configureBoard(): Promise<void> {\n    const map = this.activatedRoute.snapshot.paramMap;\n    if (map.has('boardID') && map.has('projectID')) {\n      this.boardID = this.activatedRoute.snapshot.paramMap.get('boardID') ?? '';\n      this.projectID =\n        this.activatedRoute.snapshot.paramMap.get('projectID') ?? '';\n      this.boardService.get(this.boardID).then((board) => {\n        if (board) this.board = board;\n        if (board.viewSettings && !board.viewSettings.allowBuckets) {\n          this.router.navigateByUrl(\n            `project/${this.projectID}/board/${\n              this.boardID\n            }/${board.defaultView?.toLowerCase()}`\n          );\n        }\n      });\n      // this.postService.getAllByBoard(this.boardID).then(data => {\n      //   this.posts = data;\n      // });\n      this.projectService.get(this.projectID).then((project) => {\n        this.project = project;\n      });\n    }\n  }\n\n  async loadBucketPosts(bucket: any) {\n    if (!bucket.htmlPosts) {\n      bucket.loading = true;\n      bucket.htmlPosts = await this.converters.toHTMLPosts(bucket.posts);\n      bucket.loading = false;\n    }\n  }\n\n  copyEmbedCode() {\n    const url = window.location.href + '?embedded=true';\n    navigator.clipboard.writeText(url);\n  }\n\n  copyPersonalEmbedCode() {\n    const url =\n      window.location.origin +\n      `/project/${this.projectID}/my-personal-board?embedded=true`;\n    navigator.clipboard.writeText(url);\n  }\n\n  addBucketToView(bucket: any, index: number) {\n    if (bucket && index >= 0 && index < this.buckets.length) {\n      this.buckets.splice(index, 1);\n      this.bucketsOnView.push(bucket);\n      this.loadBucketPosts(bucket);\n      this.bucketService.update(bucket.bucketID, { addedToView: true });\n    }\n  }\n\n  removeBucketFromView(bucket: any, index: number) {\n    if (bucket) {\n      this.buckets.push(bucket);\n      this.bucketsOnView.splice(index, 1);\n      this.bucketService.update(bucket.bucketID, { addedToView: false });\n    }\n  }\n\n  dragDropPostInBucket(event: CdkDragDrop<any[]>) {\n    if (event.previousContainer !== event.container) {\n      const post = event.previousContainer.data[event.previousIndex].post;\n      if (!post) return;\n      if (\n        event.container.data.filter((p) => p.post.postID === post.postID)\n          .length === 0\n      ) {\n        transferArrayItem(\n          event.previousContainer.data,\n          event.container.data,\n          event.previousIndex,\n          event.currentIndex\n        );\n      } else {\n        event.previousContainer.data.splice(event.previousIndex);\n      }\n      // transfer the html post\n      // persist post transfer with db\n      const sourceBucketId =\n        event.previousContainer.element.nativeElement.dataset.bucket;\n      const targetBucketId =\n        event.container.element.nativeElement.dataset.bucket;\n      if (sourceBucketId) {\n        this.bucketService.remove(sourceBucketId, post.postID);\n      }\n      if (targetBucketId) {\n        this.bucketService.add(targetBucketId, post.postID);\n      }\n    }\n  }\n\n  openWorkflowDialog() {\n    this._openDialog(CreateWorkflowModalComponent, {\n      board: this.board,\n      project: this.project,\n      onBucketCreation: (bucket: any) => {\n        this.bucketsOnView.push(bucket);\n        this.loadBucketPosts(bucket);\n        this.bucketService.update(bucket.bucketID, { addedToView: true });\n      },\n    });\n  }\n\n  signOut(): void {\n    this.userService.logout();\n    this.router.navigate(['login']);\n  }\n\n  private _openDialog(\n    component: ComponentType<unknown>,\n    data: any,\n    width = '700px'\n  ) {\n    this.dialog.open(component, {\n      maxWidth: 1280,\n      width: width,\n      autoFocus: false,\n      data: data,\n    });\n  }\n}\n","<app-toolbar *ngIf=\"user\" [user]=\"user\">\n    <span class=\"toolbarTitle\" *ngIf=\"board && board.name\">{{ board.name }}</span>\n    <button mat-icon-button *ngIf=\"user.role === Role.TEACHER\"\n        (click)=\"board.scope === BoardScope.PROJECT_SHARED ? copyEmbedCode() : copyPersonalEmbedCode()\"\n        matTooltip=\"Copy embeddable URL\">\n        <mat-icon>file_copy</mat-icon>\n    </button>\n    <span style=\"flex: 1 1 auto\"></span>\n    <app-view-navigation [boardID]=\"boardID\" [currentView]=\"viewType\"></app-view-navigation>\n    <app-toolbar-menu navbarMenu [board]=\"board\" [project]=\"project\"></app-toolbar-menu>\n</app-toolbar>\n<div class=\"container d-flex align-items-center justify-content-center\">\n    <div class=\"heading\">\n      <button\n        mat-icon-button\n        routerLink=\"{{'/project/'+project.projectID}}\"\n        aria-label=\"Return to Dashboard\"\n      >\n        <mat-icon>arrow_back</mat-icon>\n      </button>\n      <h1 mat-title style=\"margin: 0\"><span>CK Buckets</span></h1>\n      <span style=\"flex: 1 1 auto\"></span>\n      <div *ngIf=\"user.role === Role.TEACHER && bucketsOnView.length >= 0 && bucketsOnView.length < maxBucketsOnView\">\n          <button mat-icon-button matTooltip=\"Add bucket to view\"\n              [matMenuTriggerFor]=\"bucketsMenu\"\n              [hidden]=\"bucketsOnView.length >= maxBucketsOnView\">\n              <mat-icon class=\"material-icons-outlined\">add</mat-icon>\n          </button>\n      </div>\n    </div>\n    <div class=\"buckets\" cdkDropListGroup >\n      <h3 *ngIf=\"buckets.length === 0 && bucketsOnView.length === 0\"\n          style=\"color: grey; text-align: center\">\n          No buckets available\n      </h3>\n      \n      <div class=\"bucket\" *ngFor=\"let bucket of bucketsOnView; let idx = index\" cdkDropList [cdkDropListData]=\"bucket.htmlPosts\"\n        (cdkDropListDropped)=\"dragDropPostInBucket($event)\" [attr.data-bucket]=\"bucket.bucketID\" cdkDropListSortingDisabled >\n        <div class=\"header\">\n            <h3>{{ bucket.name }}</h3>\n            <button *ngIf=\"user.role === Role.TEACHER\"\n                mat-icon-button (click)=\"removeBucketFromView(bucket, idx)\">\n                <mat-icon>close</mat-icon>\n            </button>\n        </div>\n        <mat-spinner class=\"spinner\" *ngIf=\"bucket.loading\"></mat-spinner>\n        <h3 *ngIf=\"bucket.htmlPosts && bucket.htmlPosts.length == 0\" style=\"color: grey; margin-top: 10px;text-align: center;\">No posts in bucket!</h3>\n        <div class=\"post-list-view\" *ngIf=\"!bucket.loading\">\n          <ng-container *ngIf=\"bucket.htmlPosts && bucket.htmlPosts.length > 0\" >\n            <div *ngFor=\"let post of bucket.htmlPosts\">\n              <app-html-post [post]=\"post\" cdkDrag style=\"width: 100%\"></app-html-post>\n            </div>\n          </ng-container>\n        </div>\n      </div>\n  </div>\n</div>\n<mat-menu #bucketsMenu=\"matMenu\">\n    <button mat-menu-item *ngFor=\"let bucket of buckets; let idx = index\"\n        [value]=\"bucket\" (click)=\"addBucketToView(bucket, idx)\">\n        {{ bucket.name }}\n    </button>\n    <button *ngIf=\"user.role === Role.TEACHER && !!board && board.scope === BoardScope.PROJECT_SHARED\"\n        mat-menu-item (click)=\"openWorkflowDialog()\">\n        Create New Bucket\n    </button>\n</mat-menu>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}