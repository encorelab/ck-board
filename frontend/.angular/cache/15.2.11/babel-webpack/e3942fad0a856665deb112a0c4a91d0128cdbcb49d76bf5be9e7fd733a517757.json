{"ast":null,"code":"import _asyncToGenerator from \"/Users/marieklinaeva/github/ck-board/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { DELETE } from '@angular/cdk/keycodes';\nimport { EventEmitter } from '@angular/core';\nimport { PostModalComponent } from 'src/app/components/post-modal/post-modal.component';\nimport { getErrorMessage } from 'src/app/utils/Utils';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/comment.service\";\nimport * as i2 from \"src/app/services/upvotes.service\";\nimport * as i3 from \"src/app/services/post.service\";\nimport * as i4 from \"src/app/services/user.service\";\nimport * as i5 from \"src/app/services/socket.service\";\nimport * as i6 from \"src/app/services/canvas.service\";\nimport * as i7 from \"src/app/services/board.service\";\nimport * as i8 from \"@angular/material/legacy-dialog\";\nimport * as i9 from \"@angular/common\";\nimport * as i10 from \"@angular/material/legacy-button\";\nimport * as i11 from \"@angular/material/icon\";\nimport * as i12 from \"@angular/material/legacy-form-field\";\nimport * as i13 from \"@angular/material/legacy-card\";\nimport * as i14 from \"@angular/material/legacy-chips\";\nfunction HtmlPostComponent_mat_card_0_button_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 14);\n    i0.ɵɵlistener(\"click\", function HtmlPostComponent_mat_card_0_button_4_Template_button_click_0_listener($event) {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r6 = i0.ɵɵnextContext(2);\n      ctx_r6.movePostToBoard(ctx_r6.post.post.postID);\n      return i0.ɵɵresetView($event.stopPropagation());\n    });\n    i0.ɵɵelementStart(1, \"mat-icon\", 15);\n    i0.ɵɵtext(2, \"download\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction HtmlPostComponent_mat_card_0_mat_card_subtitle_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-card-subtitle\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r2.post.author);\n  }\n}\nfunction HtmlPostComponent_mat_card_0_mat_card_subtitle_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-card-subtitle\");\n    i0.ɵɵtext(1, \"Anonymous\");\n    i0.ɵɵelementEnd();\n  }\n}\nconst _c0 = function (a0) {\n  return {\n    \"background-color\": a0,\n    color: \"black\"\n  };\n};\nfunction HtmlPostComponent_mat_card_0_mat_chip_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-chip\", 16);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const tag_r8 = ctx.$implicit;\n    i0.ɵɵproperty(\"ngStyle\", i0.ɵɵpureFunction1(2, _c0, tag_r8.color));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", tag_r8.name, \" \");\n  }\n}\nfunction HtmlPostComponent_mat_card_0_mat_error_25_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r5.error);\n  }\n}\nconst _c1 = function (a0) {\n  return {\n    \"background-color\": a0\n  };\n};\nconst _c2 = function () {\n  return {\n    color: \"#4f47ff\"\n  };\n};\nfunction HtmlPostComponent_mat_card_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"mat-card\", 1);\n    i0.ɵɵlistener(\"click\", function HtmlPostComponent_mat_card_0_Template_mat_card_click_0_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r9 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r9.openPostDialog());\n    })(\"keyup.enter\", function HtmlPostComponent_mat_card_0_Template_mat_card_keyup_enter_0_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r11 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r11.openPostDialog());\n    });\n    i0.ɵɵelementStart(1, \"div\", 2)(2, \"div\", 3);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(4, HtmlPostComponent_mat_card_0_button_4_Template, 3, 0, \"button\", 4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(5, HtmlPostComponent_mat_card_0_mat_card_subtitle_5_Template, 2, 1, \"mat-card-subtitle\", 5);\n    i0.ɵɵtemplate(6, HtmlPostComponent_mat_card_0_mat_card_subtitle_6_Template, 2, 0, \"mat-card-subtitle\", 5);\n    i0.ɵɵelementStart(7, \"mat-card-content\")(8, \"mat-chip-list\");\n    i0.ɵɵtemplate(9, HtmlPostComponent_mat_card_0_mat_chip_9_Template, 2, 4, \"mat-chip\", 6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"p\", 7);\n    i0.ɵɵtext(11);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(12, \"mat-card-actions\", 8)(13, \"button\", 9);\n    i0.ɵɵlistener(\"click\", function HtmlPostComponent_mat_card_0_Template_button_click_13_listener($event) {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r12 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r12.handleUpvote($event));\n    });\n    i0.ɵɵelementStart(14, \"mat-icon\", 10);\n    i0.ɵɵtext(15, \"arrow_drop_up\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(16, \"button\", 11);\n    i0.ɵɵtext(17);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(18, \"button\", 12);\n    i0.ɵɵlistener(\"click\", function HtmlPostComponent_mat_card_0_Template_button_click_18_listener($event) {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r13 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r13.handleDownvote($event));\n    });\n    i0.ɵɵelementStart(19, \"mat-icon\", 10);\n    i0.ɵɵtext(20, \"arrow_drop_down\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(21, \"button\", 13);\n    i0.ɵɵlistener(\"click\", function HtmlPostComponent_mat_card_0_Template_button_click_21_listener($event) {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r14 = i0.ɵɵnextContext();\n      ctx_r14.openPostDialog(true);\n      return i0.ɵɵresetView($event.stopPropagation());\n    });\n    i0.ɵɵelementStart(22, \"mat-icon\");\n    i0.ɵɵtext(23, \"comment\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(24);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(25, HtmlPostComponent_mat_card_0_mat_error_25_Template, 2, 1, \"mat-error\", 5);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"ngStyle\", i0.ɵɵpureFunction1(12, _c1, ctx_r0.postColor));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(ctx_r0.post.post.title);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.post.bucketOnly && !ctx_r0.disableDownload);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r0.post.hideAuthorName);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.post.hideAuthorName);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.post.post.tags);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r0.post.post.desc);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngStyle\", ctx_r0.isUpvoted() && i0.ɵɵpureFunction0(14, _c2));\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngStyle\", ctx_r0.isUpvoted() && i0.ɵɵpureFunction0(15, _c2));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.post.upvotes.length, \" \");\n    i0.ɵɵadvance(7);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.post.comments, \" \");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.error);\n  }\n}\nexport class HtmlPostComponent {\n  commentService;\n  upvotesService;\n  postService;\n  userService;\n  socketService;\n  canvasService;\n  boardService;\n  dialog;\n  post;\n  disableDownload = false;\n  onCommentEvent;\n  onTagEvent;\n  movePostToBoardEvent = new EventEmitter();\n  exists = true;\n  user;\n  postColor;\n  showUsername = false;\n  error = '';\n  constructor(commentService, upvotesService, postService, userService, socketService, canvasService, boardService, dialog) {\n    this.commentService = commentService;\n    this.upvotesService = upvotesService;\n    this.postService = postService;\n    this.userService = userService;\n    this.socketService = socketService;\n    this.canvasService = canvasService;\n    this.boardService = boardService;\n    this.dialog = dialog;\n  }\n  ngOnInit() {\n    this.user = this.userService.user;\n    this.postColor = this.post.post.displayAttributes.fillColor;\n  }\n  openPostDialog(commentPress = false) {\n    var _this = this;\n    this.dialog.open(PostModalComponent, {\n      minWidth: '700px',\n      width: 'auto',\n      data: {\n        user: this.user,\n        post: this.post.post,\n        board: this.post.board,\n        commentPress: commentPress,\n        onCommentEvent: this.onCommentEvent,\n        onTagEvent: this.onTagEvent\n      }\n    }).afterClosed().subscribe( /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator(function* (value) {\n        if (value == DELETE) {\n          _this.exists = false;\n        } else {\n          _this.post.post = yield _this.postService.get(_this.post.post.postID);\n        }\n      });\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n    this.canvasService.readPost(this.post.post.postID);\n  }\n  handleUpvote(event) {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      event.stopPropagation();\n      _this2.canvasService.upvote(_this2.user.userID, _this2.post.post).catch(e => _this2.setError(getErrorMessage(e)));\n    })();\n  }\n  handleDownvote(event) {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      event.stopPropagation();\n      _this3.canvasService.unupvote(_this3.user.userID, _this3.post.post).catch(e => _this3.setError(getErrorMessage(e)));\n    })();\n  }\n  movePostToBoard(postID) {\n    this.movePostToBoardEvent.next(postID);\n  }\n  isUpvoted() {\n    return this.post.upvotes.some(u => u.voterID == this.user.userID);\n  }\n  setError(error) {\n    this.error = error;\n    setTimeout(() => this.error = '', 5000);\n  }\n  static ɵfac = function HtmlPostComponent_Factory(t) {\n    return new (t || HtmlPostComponent)(i0.ɵɵdirectiveInject(i1.CommentService), i0.ɵɵdirectiveInject(i2.UpvotesService), i0.ɵɵdirectiveInject(i3.PostService), i0.ɵɵdirectiveInject(i4.UserService), i0.ɵɵdirectiveInject(i5.SocketService), i0.ɵɵdirectiveInject(i6.CanvasService), i0.ɵɵdirectiveInject(i7.BoardService), i0.ɵɵdirectiveInject(i8.MatLegacyDialog));\n  };\n  static ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: HtmlPostComponent,\n    selectors: [[\"app-html-post\"]],\n    inputs: {\n      post: \"post\",\n      disableDownload: \"disableDownload\",\n      onCommentEvent: \"onCommentEvent\",\n      onTagEvent: \"onTagEvent\"\n    },\n    outputs: {\n      movePostToBoardEvent: \"movePostToBoardEvent\"\n    },\n    decls: 1,\n    vars: 1,\n    consts: [[\"class\", \"bucket-card\", \"role\", \"button\", \"tabindex\", \"0\", \"aria-label\", \"View post details\", 3, \"ngStyle\", \"click\", \"keyup.enter\", 4, \"ngIf\"], [\"role\", \"button\", \"tabindex\", \"0\", \"aria-label\", \"View post details\", 1, \"bucket-card\", 3, \"ngStyle\", \"click\", \"keyup.enter\"], [1, \"titleRow\"], [1, \"mat-title\"], [\"mat-icon-button\", \"\", \"style\", \"display: inline-block\", 3, \"click\", 4, \"ngIf\"], [4, \"ngIf\"], [\"selected\", \"\", 3, \"ngStyle\", 4, \"ngFor\", \"ngForOf\"], [1, \"content\"], [2, \"display\", \"flex\"], [\"mat-icon-button\", \"\", 3, \"ngStyle\", \"click\"], [2, \"transform\", \"scale(2)\"], [\"mat-icon-button\", \"\", 3, \"ngStyle\"], [\"mat-icon-button\", \"\", 3, \"click\"], [\"mat-button\", \"\", 2, \"margin-left\", \"auto\", 3, \"click\"], [\"mat-icon-button\", \"\", 2, \"display\", \"inline-block\", 3, \"click\"], [1, \"material-icons-outlined\"], [\"selected\", \"\", 3, \"ngStyle\"]],\n    template: function HtmlPostComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵtemplate(0, HtmlPostComponent_mat_card_0_Template, 26, 16, \"mat-card\", 0);\n      }\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngIf\", ctx.exists);\n      }\n    },\n    dependencies: [i9.NgForOf, i9.NgIf, i9.NgStyle, i10.MatLegacyButton, i11.MatIcon, i12.MatLegacyError, i13.MatLegacyCard, i13.MatLegacyCardContent, i13.MatLegacyCardSubtitle, i13.MatLegacyCardActions, i14.MatLegacyChipList, i14.MatLegacyChip],\n    styles: [\".bucket-card[_ngcontent-%COMP%] {\\n  cursor: pointer;\\n  border-radius: 20px;\\n  border: 2px solid black;\\n  word-wrap: break-word;\\n}\\n\\n.content[_ngcontent-%COMP%] {\\n  overflow: hidden;\\n  text-overflow: ellipsis;\\n  display: -webkit-box;\\n  -webkit-line-clamp: 4; \\n  line-clamp: 4;\\n  -webkit-box-orient: vertical;\\n}\\n\\nmat-chip[_ngcontent-%COMP%] {\\n  padding: 2px 8px !important;\\n  font-size: 12px;\\n}\\n\\n.titleRow[_ngcontent-%COMP%] {\\n  display: flex;\\n  justify-content: space-between;\\n}\\n\\n.mat-title[_ngcontent-%COMP%] {\\n  line-height: 1.2;\\n  margin-bottom: 10px;\\n}\\n\\n.upvote-button[_ngcontent-%COMP%] {\\n  font-size: 18px;\\n}\\n\\n.upvote-icon[_ngcontent-%COMP%] {\\n  font-size: 32px;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvY29tcG9uZW50cy9odG1sLXBvc3QvaHRtbC1wb3N0LmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsZUFBQTtFQUlBLG1CQUFBO0VBQ0EsdUJBQUE7RUFDQSxxQkFBQTtBQUZGOztBQUtBO0VBQ0UsZ0JBQUE7RUFDQSx1QkFBQTtFQUVBLG9CQUFBO0VBQ0EscUJBQUEsRUFBQSw0QkFBQTtFQUNBLGFBQUE7RUFDQSw0QkFBQTtBQUhGOztBQU1BO0VBQ0UsMkJBQUE7RUFDQSxlQUFBO0FBSEY7O0FBTUE7RUFDRSxhQUFBO0VBQ0EsOEJBQUE7QUFIRjs7QUFNQTtFQUNFLGdCQUFBO0VBQ0EsbUJBQUE7QUFIRjs7QUFNQTtFQUNFLGVBQUE7QUFIRjs7QUFNQTtFQUNFLGVBQUE7QUFIRiIsInNvdXJjZXNDb250ZW50IjpbIi5idWNrZXQtY2FyZCB7XG4gIGN1cnNvcjogcG9pbnRlcjtcblxuICAvLyB3aWR0aDogMTV2dztcblxuICBib3JkZXItcmFkaXVzOiAyMHB4O1xuICBib3JkZXI6IDJweCBzb2xpZCBibGFjaztcbiAgd29yZC13cmFwOiBicmVhay13b3JkO1xufVxuXG4uY29udGVudCB7XG4gIG92ZXJmbG93OiBoaWRkZW47XG4gIHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzO1xuXG4gIGRpc3BsYXk6IC13ZWJraXQtYm94O1xuICAtd2Via2l0LWxpbmUtY2xhbXA6IDQ7IC8qIG51bWJlciBvZiBsaW5lcyB0byBzaG93ICovXG4gIGxpbmUtY2xhbXA6IDQ7XG4gIC13ZWJraXQtYm94LW9yaWVudDogdmVydGljYWw7XG59XG5cbm1hdC1jaGlwIHtcbiAgcGFkZGluZzogMnB4IDhweCAhaW1wb3J0YW50O1xuICBmb250LXNpemU6IDEycHg7XG59XG5cbi50aXRsZVJvdyB7XG4gIGRpc3BsYXk6IGZsZXg7XG4gIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2Vlbjtcbn1cblxuLm1hdC10aXRsZSB7XG4gIGxpbmUtaGVpZ2h0OiAxLjI7XG4gIG1hcmdpbi1ib3R0b206IDEwcHg7XG59XG5cbi51cHZvdGUtYnV0dG9uIHtcbiAgZm9udC1zaXplOiAxOHB4O1xufVxuXG4udXB2b3RlLWljb24ge1xuICBmb250LXNpemU6IDMycHg7XG59XG4iXSwic291cmNlUm9vdCI6IiJ9 */\"]\n  });\n}","map":{"version":3,"mappings":"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","names":["DELETE","EventEmitter","PostModalComponent","getErrorMessage","i0","ctx_r6","ctx_r14","HtmlPostComponent","commentService","upvotesService","postService","userService","socketService","canvasService","boardService","dialog","post","disableDownload","onCommentEvent","onTagEvent","movePostToBoardEvent","exists","user","postColor","showUsername","error","constructor","ngOnInit","displayAttributes","fillColor","openPostDialog","commentPress","open","minWidth","width","data","board","afterClosed","subscribe","value","get","postID","readPost","handleUpvote","event","stopPropagation","upvote","userID","catch","e","setError","handleDownvote","unupvote","movePostToBoard","next","isUpvoted","upvotes","some","u","voterID","setTimeout","selectors","inputs","outputs","decls","vars","consts","template"],"sourceRoot":"","sources":["/Users/marieklinaeva/github/ck-board/frontend/src/app/components/html-post/html-post.component.ts","/Users/marieklinaeva/github/ck-board/frontend/src/app/components/html-post/html-post.component.html"],"sourcesContent":["import { DELETE } from '@angular/cdk/keycodes';\nimport { Component, EventEmitter, Input, OnInit, Output } from '@angular/core';\nimport { MatLegacyDialog as MatDialog } from '@angular/material/legacy-dialog';\nimport { PostModalComponent } from 'src/app/components/post-modal/post-modal.component';\nimport { Board } from 'src/app/models/board';\nimport Post from 'src/app/models/post';\nimport { AuthUser } from 'src/app/models/user';\nimport { BoardService } from 'src/app/services/board.service';\nimport { CanvasService } from 'src/app/services/canvas.service';\nimport { CommentService } from 'src/app/services/comment.service';\nimport { UpvotesService } from 'src/app/services/upvotes.service';\nimport { PostService } from 'src/app/services/post.service';\nimport { SocketService } from 'src/app/services/socket.service';\nimport { UserService } from 'src/app/services/user.service';\nimport { getErrorMessage } from 'src/app/utils/Utils';\nimport Upvote from 'src/app/models/upvote';\n\nexport interface HTMLPost {\n  /* Board which contains this post */\n  board: Board;\n\n  /* Associated post */\n  post: Post;\n\n  /* Author name */\n  author: string;\n\n  /* Array of post's upvotes */\n  upvotes: Upvote[];\n\n  /* Number of comments */\n  comments: number;\n\n  /* If post is only stored in a bucket */\n  bucketOnly?: boolean;\n\n  /* Display author's name as 'Anonymous' */\n  hideAuthorName?: boolean;\n}\n\n@Component({\n  selector: 'app-html-post',\n  templateUrl: './html-post.component.html',\n  styleUrls: ['./html-post.component.scss'],\n})\nexport class HtmlPostComponent implements OnInit {\n  @Input() post: HTMLPost;\n  @Input() disableDownload: boolean = false;\n  @Input() onCommentEvent: Function;\n  @Input() onTagEvent: Function;\n  @Output() movePostToBoardEvent = new EventEmitter<string>();\n\n  exists = true;\n\n  user: AuthUser;\n\n  postColor: string;\n\n  showUsername = false;\n\n  error = '';\n\n  constructor(\n    public commentService: CommentService,\n    public upvotesService: UpvotesService,\n    public postService: PostService,\n    public userService: UserService,\n    public socketService: SocketService,\n    public canvasService: CanvasService,\n    public boardService: BoardService,\n    public dialog: MatDialog\n  ) {}\n\n  ngOnInit(): void {\n    this.user = this.userService.user!;\n    this.postColor = this.post.post.displayAttributes.fillColor;\n  }\n\n  openPostDialog(commentPress = false) {\n    this.dialog\n      .open(PostModalComponent, {\n        minWidth: '700px',\n        width: 'auto',\n        data: {\n          user: this.user,\n          post: this.post.post,\n          board: this.post.board,\n          commentPress: commentPress,\n          onCommentEvent: this.onCommentEvent,\n          onTagEvent: this.onTagEvent,\n        },\n      })\n      .afterClosed()\n      .subscribe(async (value) => {\n        if (value == DELETE) {\n          this.exists = false;\n        } else {\n          this.post.post = await this.postService.get(this.post.post.postID);\n        }\n      });\n    this.canvasService.readPost(this.post.post.postID);\n  }\n\n  async handleUpvote(event) {\n    event.stopPropagation();\n\n    this.canvasService\n      .upvote(this.user.userID, this.post.post)\n      .catch((e) => this.setError(getErrorMessage(e)));\n  }\n\n  async handleDownvote(event) {\n    event.stopPropagation();\n\n    this.canvasService\n      .unupvote(this.user.userID, this.post.post)\n      .catch((e) => this.setError(getErrorMessage(e)));\n  }\n\n  movePostToBoard(postID: string) {\n    this.movePostToBoardEvent.next(postID);\n  }\n\n  isUpvoted(): Boolean {\n    return this.post.upvotes.some((u) => u.voterID == this.user.userID);\n  }\n\n  setError(error: string) {\n    this.error = error;\n    setTimeout(() => (this.error = ''), 5000);\n  }\n}\n","<mat-card\n  class=\"bucket-card\"\n  (click)=\"openPostDialog()\"\n  (keyup.enter)=\"openPostDialog()\"\n  *ngIf=\"exists\"\n  [ngStyle]=\"{ 'background-color': postColor }\"\n  role=\"button\"\n  tabindex=\"0\"\n  aria-label=\"View post details\"\n>\n  <div class=\"titleRow\">\n    <div class=\"mat-title\">{{ post.post.title }}</div>\n    <button\n      mat-icon-button\n      *ngIf=\"post.bucketOnly && !disableDownload\"\n      (click)=\"movePostToBoard(post.post.postID); $event.stopPropagation()\"\n      style=\"display: inline-block\"\n    >\n      <mat-icon class=\"material-icons-outlined\">download</mat-icon>\n    </button>\n  </div>\n  <mat-card-subtitle *ngIf=\"!post.hideAuthorName\">{{\n    post.author\n  }}</mat-card-subtitle>\n  <mat-card-subtitle *ngIf=\"post.hideAuthorName\">Anonymous</mat-card-subtitle>\n  <mat-card-content>\n    <mat-chip-list>\n      <mat-chip\n        [ngStyle]=\"{ 'background-color': tag.color, color: 'black' }\"\n        selected\n        *ngFor=\"let tag of post.post.tags\"\n      >\n        {{ tag.name }}\n      </mat-chip>\n    </mat-chip-list>\n    <p class=\"content\">{{ post.post.desc }}</p>\n  </mat-card-content>\n  <mat-card-actions style=\"display: flex\">\n    <button\n      mat-icon-button\n      [ngStyle]=\"isUpvoted() && { color: '#4f47ff' }\"\n      (click)=\"handleUpvote($event)\"\n    >\n      <mat-icon style=\"transform: scale(2);\">arrow_drop_up</mat-icon>\n    </button>\n    <button mat-icon-button [ngStyle]=\"isUpvoted() && { color: '#4f47ff' }\">\n      {{ post.upvotes.length }}\n    </button>\n    <button mat-icon-button (click)=\"handleDownvote($event)\">\n      <mat-icon style=\"transform: scale(2);\">arrow_drop_down</mat-icon>\n    </button>\n    <button mat-button style=\"margin-left: auto\" (click)=\"openPostDialog(true); $event.stopPropagation()\">\n      <mat-icon>comment</mat-icon>\n      {{ post.comments }}\n    </button>\n  </mat-card-actions>\n  <mat-error *ngIf=\"error\">{{ error }}</mat-error>\n</mat-card>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}